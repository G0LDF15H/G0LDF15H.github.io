<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Target Tier 2 | goldfish</title>
<meta name="keywords" content="">
<meta name="description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID.">
<meta name="author" content="">
<link rel="canonical" href="https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://g0ldf15h.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://g0ldf15h.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://g0ldf15h.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://g0ldf15h.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://g0ldf15h.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8YD66GB1T4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-8YD66GB1T4', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Target Tier 2" />
<meta property="og:description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-14T08:41:21-05:00" />
<meta property="article:modified_time" content="2023-07-14T08:41:21-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Target Tier 2"/>
<meta name="twitter:description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://g0ldf15h.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Target Tier 2",
      "item": "https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Target Tier 2",
  "name": "Target Tier 2",
  "description": "Incomplete; Probably won\u0026rsquo;t finish\nCheckpoint 1: \u0026ldquo;Air-gapped\u0026rdquo; Points 10\nThe FBI infiltrated SHINY SCORPION\u0026rsquo;s command \u0026amp; control network!\nThey\u0026rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They\u0026rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.\nFBI intelligence indicates that it should be possible to undo the ransomware\u0026rsquo;s encryption using the information stored in these files!\nBefore we start any decryption, though, they suggest finding our unique victim ID.",
  "keywords": [
    
  ],
  "articleBody": "Incomplete; Probably wonâ€™t finish\nCheckpoint 1: â€œAir-gappedâ€ Points 10\nThe FBI infiltrated SHINY SCORPIONâ€™s command \u0026 control network!\nTheyâ€™ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). Theyâ€™ve also included a Python script that can deobfuscate and parse the ransomware config.\nFBI intelligence indicates that it should be possible to undo the ransomwareâ€™s encryption using the information stored in these files!\nBefore we start any decryption, though, they suggest finding our unique victim ID.\nWe were given a zip containing most files we would need. In the FBI directory was a readme, a config parser, and the database of victims that Shiny Scorpion had exploited, ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹.db . I opened the binary using https://sqliteviewer.app/ to make the db easier to parse. There were three columns: id, amt, and the key .\nid = victim id amt = money to pay key = encoded RSA private key I found a record that looked familiar: the id was the address that our breached company was to send $500,000 worth of bitcoin to as stated in ransom.txt. Flag: 14hahahaEvMFqrCd2J9vsNjaUhjEdYCsTnG3r\nCheckpoint 2: The last easy one for a while Points: 10\nNow that we know our â€œcustomerâ€ ID, we should be able to find the ransomwareâ€™s decryption key.\nFlag CTFd has some limitations that make it impossible to submit the key directly ğŸ˜\nInstead, please generate and submit a SHA256 checksum of the key.\nFormat SHA256 digest, 64 hexadecimal digits, case-insensitive\nWhen hashing, ensure that you donâ€™t accidentally introduce any leading or trailing whitespace around the key. Any changes, no matter how small, will generate a completely different hash. Be careful copy/pasting!\nI took the key from the user db. I noticed that there was a repeating string at the beginning and end of the key: YF0gY . As the malware config used a public key and knowing that a private key started with -----BEGIN RSA PRIVATE KEY-----, I came to the conclusion that it had to be obfuscated. The = hinted towards base64. I tried it with ROT13, and it worked!\nFrom there, I got the sha256 checksum.\ncat key.txt | sha256sum flag: a92bbe46078d2295353bad012292f84ee0564ffb89f7bbe7cb945b8cbf1d1e51\nNote: Check the appendix for the encoded decoded private key.\nCheckpoint 3: Infinite monkey theorem Points: 10\nNow that weâ€™ve got the key, we should be able to make some headway on those encrypted files.\nThe README would be a great place to start!\nFlag format\ncp3:rest_of_the_flag, including the cp3: part, case-sensitive\nTried just uploading the file in cyberchef and decrypting with cyberchef, but didnâ€™t work because the message length was invalid. RSA is used to encrypt messages that are shorter than the modulus of the public key. -----BEGIN RSA PRIVATE KEY----- RSAPrivateKey ::= SEQUENCE { version Version, modulus INTEGER, -- n publicExponent INTEGER, -- e privateExponent INTEGER, -- d prime1 INTEGER, -- p prime2 INTEGER, -- q exponent1 INTEGER, -- d mod (p-1) exponent2 INTEGER, -- d mod (q-1) coefficient INTEGER, -- (inverse of q) mod p otherPrimeInfos OtherPrimeInfos OPTIONAL } -----END RSA PRIVATE KEY----- As the private key was 4096, the maximum length that a message could be encrypted is 512 bytes.\nDecrypted with the first 512 bytes: L3NmBaEbnKAsp2uiqJkxK2WyK3WuozEioFRuVFRuVFR= xjgufagfCj+xBeAm5brk4D== From base64 ROT13: flag: cp3:this_should_be_random!!!!!!!\nReferences https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths https://www.dcode.fr/rsa-cipher Checkpoint 4: Call for backup Points: 10\nWe need to decrypt the rest of the README.\nIt should contain contact information for the contractors that originally set this backup system up.\nWhat is the phone number for their emergency hotline?\nKey : cp3:this_should_be_random!!!!!!! IV: Â“\u000baÂ²{l?\u000fÂ¤:Â³sÃ¦Â‡Â±Ã¡\nAES Decrypt CBC/NoPadding\nflag: +1 (123) 867-5309\nCheckpoint 5: Raise the flag.txt Points: 10\nNo luck with the contractors yet; even in this emergency their fees were still deemed too high.\nThe recovery keyâ€™s not in the README, so we need to decrypt the rest of the files for them anyways.\nFlag format cp5:the_rest_the_flag, with or without the cp5 part, case-insensitive\nin keyfile bin:\nRSA Decrypt the first 512 bytes: cf076bf736b981a70b33e3480127572ea1be1beb97ba2e0 f601f99df6bacac9dd1dd6e7f113cb786\nmjqe9mn5tnpYZ+AVNFqKYdT+T+hKhv4XQTrNURq+tb8= LO+M32hfeW3E3J5/RGl3ut== base64\nÃ\u0007kÃ·6Â¹ÂÂ§\u000b3Ã£H\u0001'W.Â¡Â¾\u001bÃ«Â—Âº. gÂ€\u001cG~Â‚Â`\u001fÂ™ÃŸkÂ¬Â¬ÂÃ‘Ãn\u0011\u003cÂ·Â† Convert from base 64 Kinda stuck on this. Idea so far:\nNeed to decrypt files with RSA key and AES. However, so far, it just isnâ€™t working. What I can do so far: Extract the base64 with the RSA key. Need to make sense of wtf the key is supposed to be Decrypt with AES Get rid of first 512 bytes maybe of the decrypted text. Python Script:\nfrom Crypto.Cipher import AES def __unpad(plain_text): last_character = plain_text[len(plain_text) - 1:] return plain_text[:-ord(last_character)] for i in range(1, 102): with open(f\"cyberchef/{i}.txt\", \"r\") as aesFile: aesData = aesFile.read() aesKey = bytearray.fromhex(aesData[:64]) aesIV = bytearray.fromhex(aesData[64:]) cipher = AES.new(aesKey, AES.MODE_CBC, iv=aesIV) numString = str(i).rjust(4, \"0\") with open(f\"old_desktop/desktop cleanup.7z.{numString}.sting\", \"rb\") as cipherFile: ciphertext = cipherFile.read() ciphertext = ciphertext[512:] plaintext = cipher.decrypt(ciphertext) with open(f\"decrypted_stuff/desktop cleanup.7z.{numString}\", \"wb\") as plainFile: plainFile.write(__unpad(plaintext)) # plaintext = cipher.decrypt(ciphertext) flag : cp5:i_sure_hope_you_didn't_decrypt_this_manually\nCheckpoint 6: Are we there yet? flag: MFWG233TORPXI2DFOJSSCIJBEE======\nCheckpoint 7: El plan ",
  "wordCount" : "812",
  "inLanguage": "en",
  "datePublished": "2023-07-14T08:41:21-05:00",
  "dateModified": "2023-07-14T08:41:21-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "goldfish",
    "logo": {
      "@type": "ImageObject",
      "url": "https://g0ldf15h.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://g0ldf15h.github.io/" accesskey="h" title="goldfish (Alt + H)">goldfish</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://g0ldf15h.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://g0ldf15h.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://g0ldf15h.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Target Tier 2
    </h1>
    <div class="post-meta"><span title='2023-07-14 08:41:21 -0500 CDT'>July 14, 2023</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#checkpoint-1-air-gapped" aria-label="Checkpoint 1: &amp;ldquo;Air-gapped&amp;rdquo;">Checkpoint 1: &ldquo;Air-gapped&rdquo;</a></li>
                <li>
                    <a href="#checkpoint-2-the-last-easy-one-for-a-while" aria-label="Checkpoint 2: The last easy one for a while">Checkpoint 2: The last easy one for a while</a><ul>
                        
                <li>
                    <a href="#flag" aria-label="Flag">Flag</a><ul>
                        
                <li>
                    <a href="#format" aria-label="Format">Format</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#checkpoint-3-infinite-monkey-theorem" aria-label="Checkpoint 3: Infinite monkey theorem">Checkpoint 3: Infinite monkey theorem</a><ul>
                        
                <li>
                    <a href="#references" aria-label="References">References</a></li></ul>
                </li>
                <li>
                    <a href="#checkpoint-4-call-for-backup" aria-label="Checkpoint 4: Call for backup">Checkpoint 4: Call for backup</a></li>
                <li>
                    <a href="#checkpoint-5-raise-the-flagtxt" aria-label="Checkpoint 5: Raise the flag.txt">Checkpoint 5: Raise the flag.txt</a><ul>
                        
                <li>
                    <a href="#flag-format" aria-label="Flag format">Flag format</a></li></ul>
                </li>
                <li>
                    <a href="#checkpoint-6-are-we-there-yet" aria-label="Checkpoint 6: Are we there yet?">Checkpoint 6: Are we there yet?</a></li>
                <li>
                    <a href="#checkpoint-7-el-plan" aria-label="Checkpoint 7: El plan">Checkpoint 7: El plan</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Incomplete; Probably won&rsquo;t finish</p>
<h2 id="checkpoint-1-air-gapped">Checkpoint 1: &ldquo;Air-gapped&rdquo;<a hidden class="anchor" aria-hidden="true" href="#checkpoint-1-air-gapped">#</a></h2>
<p>Points 10</p>
<blockquote>
<p>The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!</p>
<p>They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.</p>
<p>FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!</p>
<p>Before we start any decryption, though, they suggest finding our unique victim ID.</p>
</blockquote>
<p>We were given a zip containing most files we would need.
In the FBI directory was a readme, a config parser, and the database of victims that Shiny Scorpion had exploited, <code>ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹.db</code> . I opened the binary using <a href="https://sqliteviewer.app/">https://sqliteviewer.app/</a> to make the db easier to parse. There were three columns: <code>id</code>, <code>amt</code>, and the <code>key</code> .</p>
<pre tabindex="0"><code>id = victim id
amt = money to pay
key = encoded RSA private key
</code></pre><p>I found a record that looked familiar: the id was the address that our breached company was to send $500,000 worth of bitcoin to as stated in <code>ransom.txt</code>.
<img loading="lazy" src="db_image.png" alt="image"  />

Flag: <code>14hahahaEvMFqrCd2J9vsNjaUhjEdYCsTnG3r</code></p>
<h2 id="checkpoint-2-the-last-easy-one-for-a-while">Checkpoint 2: The last easy one for a while<a hidden class="anchor" aria-hidden="true" href="#checkpoint-2-the-last-easy-one-for-a-while">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>Now that we know our &ldquo;customer&rdquo; ID, we should be able to find the ransomware&rsquo;s decryption key.</p>
<h3 id="flag">Flag<a hidden class="anchor" aria-hidden="true" href="#flag">#</a></h3>
<p>CTFd has some limitations that make it impossible to submit the key directly ğŸ˜</p>
<p>Instead, please generate and submit a SHA256 checksum of the key.</p>
<h4 id="format">Format<a hidden class="anchor" aria-hidden="true" href="#format">#</a></h4>
<p>SHA256 digest, 64 hexadecimal digits, case-insensitive</p>
<p>When hashing, ensure that you don&rsquo;t accidentally introduce any leading or trailing whitespace around the key. Any changes, no matter how small, will generate a completely different hash. Be careful copy/pasting!</p>
</blockquote>
<p>I took the key from the user db. I noticed that there was a repeating string at the beginning and end of the key: <code>YF0gY</code> . As the malware config used a public key and knowing that a private key started with <code>-----BEGIN RSA PRIVATE KEY-----</code>, I came to the conclusion that it had to be obfuscated. The <code>=</code> hinted towards base64. I tried it with ROT13,  and it worked!</p>
<p>From there, I got the sha256 checksum.</p>
<pre tabindex="0"><code>cat key.txt | sha256sum
</code></pre><p>flag: <code>a92bbe46078d2295353bad012292f84ee0564ffb89f7bbe7cb945b8cbf1d1e51</code></p>
<p><em>Note: Check the appendix for the encoded decoded private key.</em></p>
<h2 id="checkpoint-3-infinite-monkey-theorem">Checkpoint 3: Infinite monkey theorem<a hidden class="anchor" aria-hidden="true" href="#checkpoint-3-infinite-monkey-theorem">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>Now that we&rsquo;ve got the key, we should be able to make some headway on those encrypted files.</p>
<p>The README would be a great place to start!</p>
<p>Flag format</p>
<p>cp3:rest_of_the_flag, including the cp3: part, case-sensitive</p>
</blockquote>
<ul>
<li>Tried just uploading the file in cyberchef and decrypting with cyberchef, but didn&rsquo;t work because the message length was invalid.</li>
<li>RSA is used to encrypt messages that are shorter than the modulus of the public key.</li>
</ul>
<pre tabindex="0"><code>-----BEGIN RSA PRIVATE KEY-----
RSAPrivateKey ::= SEQUENCE {
  version           Version,
  modulus           INTEGER,  -- n
  publicExponent    INTEGER,  -- e
  privateExponent   INTEGER,  -- d
  prime1            INTEGER,  -- p
  prime2            INTEGER,  -- q
  exponent1         INTEGER,  -- d mod (p-1)
  exponent2         INTEGER,  -- d mod (q-1)
  coefficient       INTEGER,  -- (inverse of q) mod p
  otherPrimeInfos   OtherPrimeInfos OPTIONAL
}
-----END RSA PRIVATE KEY-----
</code></pre><p>As the private key was 4096, the maximum length that a message could be encrypted is 512 bytes.</p>
<ul>
<li>Decrypted with the first 512 bytes:</li>
</ul>
<pre tabindex="0"><code>L3NmBaEbnKAsp2uiqJkxK2WyK3WuozEioFRuVFRuVFR=
xjgufagfCj+xBeAm5brk4D==
</code></pre><p>From base64 ROT13:
flag: <code>cp3:this_should_be_random!!!!!!!</code></p>
<h3 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<ul>
<li><a href="https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths">https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths</a></li>
<li><a href="https://www.dcode.fr/rsa-cipher">https://www.dcode.fr/rsa-cipher</a></li>
</ul>
<h2 id="checkpoint-4-call-for-backup">Checkpoint 4: Call for backup<a hidden class="anchor" aria-hidden="true" href="#checkpoint-4-call-for-backup">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>We need to decrypt the rest of the README.</p>
<p>It should contain contact information for the contractors that originally set this backup system up.</p>
<p>What is the phone number for their emergency hotline?</p>
</blockquote>
<p>Key : <code>cp3:this_should_be_random!!!!!!!</code>
IV: <code>Â“aÂ²{l?Â¤:Â³sÃ¦Â‡Â±Ã¡</code></p>
<p>AES Decrypt CBC/NoPadding</p>
<p>flag: <code>+1 (123) 867-5309</code></p>
<h2 id="checkpoint-5-raise-the-flagtxt">Checkpoint 5: Raise the flag.txt<a hidden class="anchor" aria-hidden="true" href="#checkpoint-5-raise-the-flagtxt">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>No luck with the contractors yet; even in this emergency their fees were still deemed too high.</p>
<p>The recovery key&rsquo;s not in the README, so we need to decrypt the rest of the files for them anyways.</p>
<h3 id="flag-format">Flag format<a hidden class="anchor" aria-hidden="true" href="#flag-format">#</a></h3>
<p><code>cp5:the_rest_the_flag</code>, with or without the <code>cp5</code> part, case-insensitive</p>
</blockquote>
<p>in keyfile bin:</p>
<p>RSA Decrypt the first 512 bytes:
cf076bf736b981a70b33e3480127572ea1be1beb97ba2e0
f601f99df6bacac9dd1dd6e7f113cb786</p>
<pre tabindex="0"><code>mjqe9mn5tnpYZ+AVNFqKYdT+T+hKhv4XQTrNURq+tb8=
LO+M32hfeW3E3J5/RGl3ut==
</code></pre><p>base64</p>
<pre tabindex="0"><code>ÃkÃ·6Â¹ÂÂ§3Ã£H&#39;W.Â¡Â¾Ã«Â—Âº.
gÂ€G~Â‚Â`Â™ÃŸkÂ¬Â¬ÂÃ‘Ãn&lt;Â·Â†
</code></pre><p>Convert from base 64
Kinda stuck on this.
Idea so far:</p>
<ul>
<li>Need to decrypt files with RSA key and AES. However, so far, it just isn&rsquo;t working.</li>
<li>What I can do so far: Extract the base64 with the RSA key.
<ul>
<li>Need to make sense of wtf the key is supposed to be</li>
</ul>
</li>
<li>Decrypt with AES</li>
<li>Get rid of first 512 bytes maybe of the decrypted text.</li>
</ul>
<p>Python Script:</p>
<pre tabindex="0"><code>from Crypto.Cipher import AES

def __unpad(plain_text):
Â  Â  last_character = plain_text[len(plain_text) - 1:]
Â  Â  return plain_text[:-ord(last_character)]

for i in range(1, 102):
Â  Â  with open(f&#34;cyberchef/{i}.txt&#34;, &#34;r&#34;) as aesFile:
Â  Â  Â  Â  aesData = aesFile.read()
Â  Â  Â  Â  aesKey = bytearray.fromhex(aesData[:64])
Â  Â  Â  Â  aesIV = bytearray.fromhex(aesData[64:])
Â  Â  Â  Â  cipher = AES.new(aesKey, AES.MODE_CBC, iv=aesIV)
Â  Â  Â  Â  numString = str(i).rjust(4, &#34;0&#34;)
Â  Â  Â  Â  with open(f&#34;old_desktop/desktop cleanup.7z.{numString}.sting&#34;, &#34;rb&#34;) as cipherFile: Â 
Â  Â  Â  Â  Â  Â  ciphertext = cipherFile.read()
Â  Â  Â  Â  Â  Â  ciphertext = ciphertext[512:]
Â  Â  Â  Â  Â  Â  plaintext = cipher.decrypt(ciphertext)
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  with open(f&#34;decrypted_stuff/desktop cleanup.7z.{numString}&#34;, &#34;wb&#34;) as plainFile:
Â  Â  Â  Â  Â  Â  Â  Â  plainFile.write(__unpad(plaintext))
# plaintext = cipher.decrypt(ciphertext)
</code></pre><p>flag : <code>cp5:i_sure_hope_you_didn't_decrypt_this_manually</code></p>
<h2 id="checkpoint-6-are-we-there-yet">Checkpoint 6: Are we there yet?<a hidden class="anchor" aria-hidden="true" href="#checkpoint-6-are-we-there-yet">#</a></h2>
<p>flag: <code>MFWG233TORPXI2DFOJSSCIJBEE======</code></p>
<h2 id="checkpoint-7-el-plan">Checkpoint 7: El plan<a hidden class="anchor" aria-hidden="true" href="#checkpoint-7-el-plan">#</a></h2>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://g0ldf15h.github.io/posts/dev_notes/python/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Python Notes</span>
  </a>
  <a class="next" href="https://g0ldf15h.github.io/posts/target_ctf/tier1/target1/">
    <span class="title">Next Â»</span>
    <br>
    <span>Target I: Cryptography and Steganography</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://g0ldf15h.github.io/">goldfish</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
