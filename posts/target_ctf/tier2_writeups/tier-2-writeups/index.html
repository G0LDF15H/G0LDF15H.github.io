<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Target Tier 2 | goldfish</title>
<meta name="keywords" content="">
<meta name="description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID.">
<meta name="author" content="">
<link rel="canonical" href="https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://g0ldf15h.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://g0ldf15h.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://g0ldf15h.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://g0ldf15h.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://g0ldf15h.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8YD66GB1T4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-8YD66GB1T4', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Target Tier 2" />
<meta property="og:description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-14T08:41:21-05:00" />
<meta property="article:modified_time" content="2023-07-14T08:41:21-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Target Tier 2"/>
<meta name="twitter:description" content="Incomplete; Probably won&rsquo;t finish
Checkpoint 1: &ldquo;Air-gapped&rdquo; Points 10
The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!
They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.
FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!
Before we start any decryption, though, they suggest finding our unique victim ID."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://g0ldf15h.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Target Tier 2",
      "item": "https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Target Tier 2",
  "name": "Target Tier 2",
  "description": "Incomplete; Probably won\u0026rsquo;t finish\nCheckpoint 1: \u0026ldquo;Air-gapped\u0026rdquo; Points 10\nThe FBI infiltrated SHINY SCORPION\u0026rsquo;s command \u0026amp; control network!\nThey\u0026rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They\u0026rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.\nFBI intelligence indicates that it should be possible to undo the ransomware\u0026rsquo;s encryption using the information stored in these files!\nBefore we start any decryption, though, they suggest finding our unique victim ID.",
  "keywords": [
    
  ],
  "articleBody": "Incomplete; Probably won‚Äôt finish\nCheckpoint 1: ‚ÄúAir-gapped‚Äù Points 10\nThe FBI infiltrated SHINY SCORPION‚Äôs command \u0026 control network!\nThey‚Äôve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They‚Äôve also included a Python script that can deobfuscate and parse the ransomware config.\nFBI intelligence indicates that it should be possible to undo the ransomware‚Äôs encryption using the information stored in these files!\nBefore we start any decryption, though, they suggest finding our unique victim ID.\nWe were given a zip containing most files we would need. In the FBI directory was a readme, a config parser, and the database of victims that Shiny Scorpion had exploited, –∫–ª–∏–µ–Ω—Ç—ã.db . I opened the binary using https://sqliteviewer.app/ to make the db easier to parse. There were three columns: id, amt, and the key .\nid = victim id amt = money to pay key = encoded RSA private key I found a record that looked familiar: the id was the address that our breached company was to send $500,000 worth of bitcoin to as stated in ransom.txt. Flag: 14hahahaEvMFqrCd2J9vsNjaUhjEdYCsTnG3r\nCheckpoint 2: The last easy one for a while Points: 10\nNow that we know our ‚Äúcustomer‚Äù ID, we should be able to find the ransomware‚Äôs decryption key.\nFlag CTFd has some limitations that make it impossible to submit the key directly üòû\nInstead, please generate and submit a SHA256 checksum of the key.\nFormat SHA256 digest, 64 hexadecimal digits, case-insensitive\nWhen hashing, ensure that you don‚Äôt accidentally introduce any leading or trailing whitespace around the key. Any changes, no matter how small, will generate a completely different hash. Be careful copy/pasting!\nI took the key from the user db. I noticed that there was a repeating string at the beginning and end of the key: YF0gY . As the malware config used a public key and knowing that a private key started with -----BEGIN RSA PRIVATE KEY-----, I came to the conclusion that it had to be obfuscated. The = hinted towards base64. I tried it with ROT13, and it worked!\nFrom there, I got the sha256 checksum.\ncat key.txt | sha256sum flag: a92bbe46078d2295353bad012292f84ee0564ffb89f7bbe7cb945b8cbf1d1e51\nNote: Check the appendix for the encoded decoded private key.\nCheckpoint 3: Infinite monkey theorem Points: 10\nNow that we‚Äôve got the key, we should be able to make some headway on those encrypted files.\nThe README would be a great place to start!\nFlag format\ncp3:rest_of_the_flag, including the cp3: part, case-sensitive\nTried just uploading the file in cyberchef and decrypting with cyberchef, but didn‚Äôt work because the message length was invalid. RSA is used to encrypt messages that are shorter than the modulus of the public key. -----BEGIN RSA PRIVATE KEY----- RSAPrivateKey ::= SEQUENCE { version Version, modulus INTEGER, -- n publicExponent INTEGER, -- e privateExponent INTEGER, -- d prime1 INTEGER, -- p prime2 INTEGER, -- q exponent1 INTEGER, -- d mod (p-1) exponent2 INTEGER, -- d mod (q-1) coefficient INTEGER, -- (inverse of q) mod p otherPrimeInfos OtherPrimeInfos OPTIONAL } -----END RSA PRIVATE KEY----- As the private key was 4096, the maximum length that a message could be encrypted is 512 bytes.\nDecrypted with the first 512 bytes: L3NmBaEbnKAsp2uiqJkxK2WyK3WuozEioFRuVFRuVFR= xjgufagfCj+xBeAm5brk4D== From base64 ROT13: flag: cp3:this_should_be_random!!!!!!!\nReferences https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths https://www.dcode.fr/rsa-cipher Checkpoint 4: Call for backup Points: 10\nWe need to decrypt the rest of the README.\nIt should contain contact information for the contractors that originally set this backup system up.\nWhat is the phone number for their emergency hotline?\nKey : cp3:this_should_be_random!!!!!!! IV: ¬ì\u000ba¬≤{l?\u000f¬§:¬≥s√¶¬á¬±√°\nAES Decrypt CBC/NoPadding\nflag: +1 (123) 867-5309\nCheckpoint 5: Raise the flag.txt Points: 10\nNo luck with the contractors yet; even in this emergency their fees were still deemed too high.\nThe recovery key‚Äôs not in the README, so we need to decrypt the rest of the files for them anyways.\nFlag format cp5:the_rest_the_flag, with or without the cp5 part, case-insensitive\nin keyfile bin:\nRSA Decrypt the first 512 bytes: cf076bf736b981a70b33e3480127572ea1be1beb97ba2e0 f601f99df6bacac9dd1dd6e7f113cb786\nmjqe9mn5tnpYZ+AVNFqKYdT+T+hKhv4XQTrNURq+tb8= LO+M32hfeW3E3J5/RGl3ut== base64\n√è\u0007k√∑6¬π¬Å¬ß\u000b3√£H\u0001'W.¬°¬æ\u001b√´¬ó¬∫. g¬Ä\u001cG~¬Ç¬è`\u001f¬ô√ük¬¨¬¨¬ù√ë√ùn\u0011\u003c¬∑¬Ü Convert from base 64 Kinda stuck on this. Idea so far:\nNeed to decrypt files with RSA key and AES. However, so far, it just isn‚Äôt working. What I can do so far: Extract the base64 with the RSA key. Need to make sense of wtf the key is supposed to be Decrypt with AES Get rid of first 512 bytes maybe of the decrypted text. Python Script:\nfrom Crypto.Cipher import AES def __unpad(plain_text): last_character = plain_text[len(plain_text) - 1:] return plain_text[:-ord(last_character)] for i in range(1, 102): with open(f\"cyberchef/{i}.txt\", \"r\") as aesFile: aesData = aesFile.read() aesKey = bytearray.fromhex(aesData[:64]) aesIV = bytearray.fromhex(aesData[64:]) cipher = AES.new(aesKey, AES.MODE_CBC, iv=aesIV) numString = str(i).rjust(4, \"0\") with open(f\"old_desktop/desktop cleanup.7z.{numString}.sting\", \"rb\") as cipherFile: ciphertext = cipherFile.read() ciphertext = ciphertext[512:] plaintext = cipher.decrypt(ciphertext) with open(f\"decrypted_stuff/desktop cleanup.7z.{numString}\", \"wb\") as plainFile: plainFile.write(__unpad(plaintext)) # plaintext = cipher.decrypt(ciphertext) flag : cp5:i_sure_hope_you_didn't_decrypt_this_manually\n6 flag: MFWG233TORPXI2DFOJSSCIJBEE======\nRANDOM NOTES Checkpoint 2 Obfuscated Key YF0gYF1PEHqWGvOFH0RtHSWWIxSHEFOYEIxgYF0gYDcAFHyXF0SWDxSOF0AOM0IOqH5iYlgeISN0E2peAypkM0AlGJA3E3AuX1A6oTIFFySfIHI5MmS4X0L0Lz12nSAIPwIzAJ41Yl83MzWuH24kLwNmnRufq1E1qJAWnKAwnzZ5oHgcDKInM3qzBUSQJRIYDxuxJSOSLGOioRcvnQAIZwHXI0k0ZKqRF0jlFUuenUy4nGOdGTSaM2cxq2MmGUOJLH4eMH5EImMWrxgbMQVinmMzpSMBFzp0ZJI1pSOWqJAmDtb2LxZeA3N2oScYF3SXIx16pTMLAyqcqJcHE3c1H1AAEyEyJSIVEHWbG0H0BIMDrQW5pyuvnwSjM3uDMRMBpQOcPxWHA1AgZyIBIx5EIyE5q3ydDyqUHwqiHlgCMHMjLKAFIzMup0MLX2kVIKS5IJ8kZx9OqvgiIGASIxSPXmAXGUHXnx1OoJp2I0WuqztlDIb2AKccGUcGpTyOrJujDxqhH3c1nQuQLxMxp2SWDJETJx5hBH9CJP83n1qUAwqjHF8injc4ESZ3oQqHMGuEn3yyFGteAxqKL0cfoHg1DHHjJwIiqyyXrIEHLKSDE3SEoytlITynIyW5JGIjpQSnFTc3Ll9mPzulLHqWD3WXY1c2IRjiEwODrIOOGSA0ZJyTAT5XAKW2Ix1FoTE3rGAcD0SlrUWaGIEZY0SSnJV0rJxkpyMYBSxXoxV1LIE2ZRqOJF9ILJ8irSccnHg1nIyPZGuZIHqzH0gRAycaJISkpUWUoUyxD2A1JKSCISIYER1aY2kzLHcjrNcCnxxmnQHioJchF0blD1EXL0kGGR1Go010MJZlMKSCZGMKDJ5JZJ9xo1umoTMkGT0krT5nMwI5ARkMITgHXmy4PySfD1MWGTZ3IT1kp0V1nyyeJzgRoTHjMTDmAH9LBKM3IRIQFxHmEUM1ZJSZqz5SGQOvZ1IAY1S4JzqwD0S3EHRXDISYD0SaDaEQozkOAIIGE2yXMxjkFSSnXmM3IRgJp0R3Zyu4qRIwF3EQozR2IQWAFSI5HzuwrHkgryqjZzq0BDcRLKyGDwInp1WZrQR3q0qiLJgvoxuEITE2ZHShpKAgAHgRn2W1IR0lAyDeA21jrTAaoHV3rzMFqJccASyeHTyRPyuUIzgaZGyZrSAgZxqEpx8eJKWKFTyynwHkAT9hAIbjZKIQMzuZqIWjZmM1BJb2HwMmnmWXA1MuFwMCFyqBJIVXMTp3Gwt3Iwu5JKMRn3qbDwyyHTIQpILiJSOjrRf5raEzG0quBGN0HUN1IQqdDHqLIUOTpJECnUcfLKOaMTq5IjcXFHEjL2uLnxyhGyAvn1u3qmEhFUM4DwplDIqApyN0Zx9RESqfAHuZZlf5ZH1IZxMcBRMXZJMuJQWgIJE0HKyFPzgRrwOULxWvEGM6I0kDZyE1n2V3EayjFaIGBSS2oIOgqGH3AxuwHKOio2g0oTfko2guBT9LrzuwZTcLE0W5LHRXDKOHDmqjZ20eZ0uloTq4XmAhJJtlnaunD3OHZQM5Mv8ep0yWD2y3GR9WZUucMItiF0gdLJgFrxW4FSZmHxcVGjbeH3EVqTVlEKEXoxMfEat1nHMCG2SlMHkFnwAcJTA1DwAUqxAiMwx4ZwuQLzH1oz9JGxq3rQWBH2yZG2gXEx9KPv9HEQO2rRqYJGSunaSSMTEGIxM3qHgGMHIFFTqMoxWloH1ZJTL2JIL4oQt5pIOdqIuEG3AEMaWDFGWPMP8eIzjXrJWJGmuUGUuQMSETF2M3oHWTqTgPoyuQLmplJIW3EHkZZUIVHQp2Y1EfJxSnnzAuLwLinJWyZauXI3SGrSWUHtcZGRyYrwDeEUNkoyuQITuenT9MrUqTH1MVMzA5naWOGHA1Y2yZE2DjJwyYpRt1HSNjHHgQDISSDGMkFIuWE1WHPv8iESOTp1IAD0LiJIyup0clq3ESY2p1EJ84AmMFMGySHzAfEwyyM1OKDwDmoJygHKySJJclHT9AqJL4JUA4JzxXMxSZD2EIG2gvAISwL045EF9YHHEYrwt5ZQyjY2yno3y0DyMwL0AHqIuZZl9zq2R1Z28joIAyp09zH2EeG0knnjcnHJuYGIEerUWgI2MvnJufZKMBo0D2IKckLHcEZJMaZQSloSx2nT1DoUE5EUcTEIZ1HxWLExferJAQHlglL29QPacVHKqIrxqmFTMaGHWjEP9Bn1AhA2cAXmLeM0IKH1qfDxcMEIMnqUqQD21uHRMZGHIvHJuEM2uZESSdBT1cAwtXX1qAIGD4HSScnR9kFHgQGxMRqHkln3ImJStjpGq3Y0uEFRIYBJMaLzuSFQEjJIqXZRcGF3OwnHqcETWGnJ1zHjcSpaEbGRp3BIu1GxMGHHgQDISSDKyuX2g4Fzx2GTkBnGAFGzI0FGWPJR01BQAIq2cOqaEIM1R2F0WOG1EhrSMUPxM4nSy4o2Vlp1R1rwEiGSy4ZHkuEKSPqR1Lq3uLBKE2LycmLacIowSwZ21OAJIcozbjoTqBrHIjEwSvAJEJqKpXZF85qytkHUMRpTkgpz45JIERrSIuryqUA0qHAJAfH1OhEIMdAaOwEzMYLH02ITELLaOfAIyiMUywpRM0n1WAHDcgEmyIY0gDZz9hESWUpSSBIT1lomAYHJ9MA2xjJwyXM1ZjZSI3oUIVI0MQH2WUrGA5G1NmIxyxn1IRLzIYIRSCPzICq3APHGWXDyWlJR5yL252EmqfJKIRG1W2qv9LIUS2GmWyZUWOH2beqUq5AzgSITu0HR0kM3t1pxMPHwu3E1ZXMHgxZQynHJ9cIH5RD2LepGuZrJERMIElrSMCozS4DzggLH9kLJIfM3c3F0AOHHIOAyAZAmyvrJRko0yFIGRenNcmD1ASFTRiIIcVDl9AMGN5MH1YqSunJQp4JzIhMmOlBHEQF2yDqyHjFTc2GR1FFIyKH3MUDJWKpSDeZKyQHxAMPx1QFKAREwywA2IyG0qiMKuGFR1aGRklnUcXqmIQEzf1Zab4H3qmJH5WA3teo2p0EJcWnwMbJUD5ZRSVoaWhMSLXESABX3qzLmOSMUq6qUMODJ9VpTH5MKxkoF9VAHEep3EkGJ9xrwEBryIxJTkiHRMzISW6EaEgpmWIpGqIJJSLEjcdqSAmFzf0oKIULHcmnQMZIGx1pzx2ITcRMIbeEJpmpayAD0M0AHEFo25go1udGzEJZaEjnGN0GTyMIyReI3MJPxb0ZyycqJcwpScRrRu0G2gFnSAvBGEFoxAVo0gKHx1nIRMMBQWIGIAQDIuOpJxiHKEIFGperzudqyAwM3cOISRXnwSmoUIEF0AOHHRmrTVlHUWPnSyBIRE5pQMyJwOSHRImIJg3HSW5ZJDlEUL2ZxWnF2EOFaM1ZHb5AwMwYmqxAtcIGv9IBHcOIQSkFwyMnIq2X0yADmWaD2MIA1WTMJVkFzIWEJMepmV3HUMEY2Sin2EvnKxiqJ1XIwMAo1yfZ0cJPxuRD2V4pSI0HwuKn2MOFTShryqhZayPZ2HlrzZ4Z1WBX3uGMJWLFzEWEGARAHqvG3WwAyc2pJWjGHqbIxIBJzfXFwOFAmOPGGH2rxAVrGSTpvgcnyWGHJcxAzI2nKVjGT5BnJxmoIO6MUWwHmEyEyWGFzgiLxx3FUZlFKNmqabkrtc6qGyGMTSQZTSOpRR1Fv9UImW0GTguZ2ubFyIyqHxmGHIfJwWTrTWuHKMgrFfmFKIXZaM5DJx1FwyGryO1El9nPyOKGaEaI2b0BGZeFmS4FJ4lERMSZKu5pKRepGSZHzEvDJ9WDxSTnJc5Zyy3DmZlnQyBGzb2oTgiY3MgoGEUqTHXFHSWBSIzHxALLKARnQyXGJ5Bo0cxH1cCBH5IFyqaqauSnSqMDxxiHHxeFmN5A09ZZHgzoTICp1VkoyEAIHubBNcCY1EApT8kHKulH0ZlE1D2G0EgBScbMyWKL0g3DGR0ZKylIxyGFUIPFHgyGRp5Y21Vp1cfrKWKMH9RX2f2MwpePzt1BKEPMzuIEvf5X0cSY3ugnHyAZTcDqUyFqz43nGL2EJgcY1cUBUq5LJSlAUS6q1WRDaEXMaS1LzIZI0McD3tXBGAvZRAmrTEzBJuyEzSyZGOWIxy5F0WFIxIznHk2ZJkmFKAVX2ReDacRMKZeZUx0X2RlJTcnnaO2X0SkATcxItcyJSAinTAGIz9eJItmI3D1nTIGpFgxE1AhJJyVrRqOA1WTrHf4FIqZDIc1AHWbHzIyZQADZJ5VqSylBQ0XYF0gYF1SGxDtHyAOVSOFFIMOIRHtF0IMYF0gYF0= Private Key -----BEGIN RSA PRIVATE KEY----- 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 -----END RSA PRIVATE KEY----- Checkpoint 3 Break down of private key n= 754132563051154723403056919085147110311133969558691172856763166524777168216327231572688983272651071384410989555765073384227847203967898583163778576674592638643894981063661758701895920293752410921904830425769840957388609936914426615449641253167341554558554896373279982678489077450677056403673579582197256645666964578855498707133133520774701913984887474507699727510225382531085555646232361369589782565347533475192685577520962875555257293624776892223997768842012136044305966952644626419533183179058216496711599208997691198629424782252445331648629055085283904880421614417255352679652743508611647403689314891629287925358294341834219043393585986994642657061012385558466362837408728572409995430373373914848887867170333924758538747997757627071801942338132033490742485200905279828308647666846410535414695804958619756196798192136283218901229315089387818331114101607912554296186569958878491168304917484637812697279431567296217310773651137984960810009666264110079742835171525714026020997412734485334841653350210761671402225532082583194765792779700038176856577873636425662145937788074423007467772148122154326183096029207961687986811780220913433282966678342660918132055128232450696197630100253626488669210066100888824348737281133173304845579412999 e= 65537 d = 444848112592803919191277864945186721050980791448638815500703530138415865023955848533936301697322394504630124131960907151088153944461830589232471977595298485089862765658179347996652187049089437322885070104366026543352400499735642744200492564600092423481074411994669131183418668006862143880702761998079920421515162177914380037521702378498088122629076168835820433736939485531367570925243707496329880894666681364991898190966673845401692047457775758372942456103626152666994588956197088862058582610116599654338369376392598746476264288220353145188280675657140096110170120569398579111687984059377415459652184634565156200412349842307478993214342508757083636120926301335692205947748178813477405599214801815347774543584973770843772818771124872590232967245303988658658134678249963442159036841649693249092984575182591856634390232750683306363544630805469532809144470820886907591825604716468767798385224161783851629890408039558835483740980322398095901172896150846694201756162369137023747144163734463876587528543321411884430475826359885640569384581558444391957088839672994266181345464758927043135541707134214557969972110812763106085036691439133145059124009972496173175277957308377534594150843570239663860992616991463371579776048299063414510832570321 p= 29619693086752711766021320625068275863761447740035882305415221373897944301508180673276038882880573629992892857285938836226023124608787436752411636144902417215966096669674265733140409695828506298986141448818642507196716040955120246370386206384847545783408518406172857581502254875790712378908742886712556322269380555485452742280777508292098844527593121389676061356774791843328356176213860412135636821224805836017635135730756621911219268023402924056094485784295209274462808479945005504161284005934293403969538876771571212644411568533925099142424724554130367207976779229010512231394539878815722382848358286098653037937993 q = 25460512397693866372980588707822354119704308422591700762218265832943479094435728938872640441714298908148555060200321284902131108412210985248560012716406948618825611895457745513653222321392804303046726085650461979598069725427530550329964808173888419730493851988042069672885317171725177737179962758468744778792518468198265900094686580064425581124462711544611663414177299764828259843914504646060864449181380524220731758105814571430737656140738788098202604809442792736003230833005267659506870028431189727697264835528888953071167636345837250606086986022267874011873983650256282179190462959490422992139974356437243617960143 dmp1= 29430776418149287234562802352622504172792189379791516545559512956755119016279524806797112715173109452851170941202725957492750657665130065365828361599095175346544642706143377180468595434375337621247212185568780710532110897217701074559305115790696664996410871875300522038693338652312669170120060851730090714403463576188369884562643248279188621035328691758461867944700210111016665789384170410269932010335201965845741831387630505855267826028288981973676195428346121011699400726391791101598770971854605065430099060324518146942817598171424821567291081957373932011172923487708249477336177157462212579896886388337247465973177dmq17040616234850633081732871647342181114658913003992086804609329564832608627621934411999158684791617546002659007217456133882864978222294271719176238009970598742984521177066095822877723242299796944994671969272980491268379962981569741728030764583904967129647986321914131386570953859700251707141194517169370914537693397609856613934357765697355460376865552608801092147262389240245701712792202384920900352663597040457334355435123326945683484783230984889508610509506564730680173831370896833746479172456146168348528779380961205067500359697508407353618787061988810606484767470186224604932614556889160869227348753554666311980891 iqmp = 11189740929117537969824023300230738150107991156370618382495471880429452034455487515216178022590736073233261472653559078493715464148137211339924958961731816784132712329088002190498783589140155408064576534314899706633172767848157833801182456574698733900779320799873806292980672045756164339890172911335565832039216656177027927640142834517596282977009036183634786371922040319146715581022085409348646273894855663683921072095426601622999851082503292037562512135101302312256155521247862483338388580064120104061339213825399930063472280827979159422806485373220500086750207047726859247411928439097893506143942281890245867561663 bits = 4096 Checkpoint 4 The entire read me\nRecovery Instructions\nCreated: 2021-03-15, Olivia Huile, TBO\nLast updated: 2022-04-20, bart\nRecovery It‚Äôs as easy as 1, 2, 3!\nInsert one of the recovery USB thumb drives into this air-gapped laptop Double-click recover.py on the desktop and follow the onscreen instructions Transmit the (case-insensitive) output to the storage team, so they can decrypt the tape Hardware 4x LTO-6 drives rotated monthly to Steel Mountain‚Äôs secure facility 1x air-gapped recovery laptop (you‚Äôre looking at it) 2x recovery USB thumb drives 1 primary stored in admin‚Äôs locking file cabinet. Contact Bart Thatch for more info. 1 backup kept in bank safe deposit box. Contact legal team for retrieval info. Architecture Tape contents: key.enc.b32.txt - recovery key blob, Base32-encoded (see details below) nonce.bin - AES-CTR nonce .tgz.aes.bin: the backup archive, encrypted using included (encrypted) AES-128 key Laptop contents: recover.py - script that decrypts recovery key offline_recovery.kbdx - KeePass DB containing private key this README USB contents: key.bin - KeePass key file Reference Recovery key blob in key.enc.b32.txt.\nStruct is Base32-encoded for easier transfer over the phone. All sizes in decimal bytes:\nOffset Length Type (golang) Description 0 12 []byte ChaCha20-Poly1305 nonce 12 32 []byte Encrypted (ChaCha20-Poly1305) AES-128-CTR key 60 1 uint8 Size of Public Key data (next field) 61 see prev []byte X9.62-compressed secp256r1 Public Key Note: the ChaCha20-Poly1305 Authenticated Encryption uses the Public Key bytes as Authenticated Data.\n0 - 11 mjqe9mn5tnpY 12- 31 Z+AVNFqKYdT+T+hKhv4XQTrNURq+tb8= LO+M32hfeW3E3J5 60 / 61 RGl3ut== TODO Remove KeePass dependency (legacy requirement) Disable network devices on this laptop to prevent accidental connections Help Drop us a question in the #infrasec-support Slack channel, or email us at infrasec@kissec.example.\nFor emergency recovery operations, call the original contractor‚Äôs hotline.\nTailored Backup Operations: +1 (123) 867-5309\nFrom yarrr.url.sting:\nnCZ5KjTkXsoht7OD1TiJ965lw1q1HoW9at5etCJ9xRb= SQvrk8kmMRNJFiuWqa//lj== √®hb¬ëu¬üH4¬Ω3N¬∂√Ç¬Ñ: t] URL=https://thepiratebay.org.example IDList= HotKey=0 Desktop2:\nWS4yqIWqJyTtRSN9qYI2nMDmHQy42/YmajWiS2mMAr0= srZqE2kuJDbKVYbLvmvAVj== Desktop3\nwHTBeVjZTRSlKjEvhAtyocM4YT9+LmAxX0ZoifVcFdH= BGCgcVZ3xW6fx7heYK01xj== Desktop 32\nva+11hLjyQ3r1Yr2XjokOMzpQqL3UvphdetQ+92mkHV= TqsdXribAvR8QGzhEXdApt== ee2:i_yam_what_i_yam\ncf076bf736b981a70b33e3480127572ea1be1beb97ba2e0a0c67801c477e828f 601f99df6bacac9dd1dd6e7f113cb786\n^^^ keyfile\n472ff95a432f44c15187c21253d98bcd5ce2338a8b92fb3e75377dd58ba91671 c7b2a189cfb775cc18d66f27c32d9f91 El/5JxZiEZSEu8VFH9zYmImvZ4dYxif+qGq91LhcSaR= k7Xuvp+3qpjL1z8ajl2sxD==\nG/√πZC/D√ÅQ¬á√Ç\u0012S√ô¬ã√ç\\√¢3¬ä¬ã¬í√ª\u003eu7}√ï¬ã¬©\u0016q√á¬≤¬°¬â√è¬∑u√å\u0018√ño‚Äô√É-¬ü¬ë ^ 0001\n",
  "wordCount" : "1219",
  "inLanguage": "en",
  "datePublished": "2023-07-14T08:41:21-05:00",
  "dateModified": "2023-07-14T08:41:21-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://g0ldf15h.github.io/posts/target_ctf/tier2_writeups/tier-2-writeups/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "goldfish",
    "logo": {
      "@type": "ImageObject",
      "url": "https://g0ldf15h.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://g0ldf15h.github.io/" accesskey="h" title="goldfish (Alt + H)">goldfish</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://g0ldf15h.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://g0ldf15h.github.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://g0ldf15h.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Target Tier 2
    </h1>
    <div class="post-meta"><span title='2023-07-14 08:41:21 -0500 CDT'>July 14, 2023</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul>
                <li>
                    <a href="#checkpoint-1-air-gapped" aria-label="Checkpoint 1: &amp;ldquo;Air-gapped&amp;rdquo;">Checkpoint 1: &ldquo;Air-gapped&rdquo;</a></li>
                <li>
                    <a href="#checkpoint-2-the-last-easy-one-for-a-while" aria-label="Checkpoint 2: The last easy one for a while">Checkpoint 2: The last easy one for a while</a><ul>
                        
                <li>
                    <a href="#flag" aria-label="Flag">Flag</a><ul>
                        
                <li>
                    <a href="#format" aria-label="Format">Format</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#checkpoint-3-infinite-monkey-theorem" aria-label="Checkpoint 3: Infinite monkey theorem">Checkpoint 3: Infinite monkey theorem</a><ul>
                        
                <li>
                    <a href="#references" aria-label="References">References</a></li></ul>
                </li>
                <li>
                    <a href="#checkpoint-4-call-for-backup" aria-label="Checkpoint 4: Call for backup">Checkpoint 4: Call for backup</a></li>
                <li>
                    <a href="#checkpoint-5-raise-the-flagtxt" aria-label="Checkpoint 5: Raise the flag.txt">Checkpoint 5: Raise the flag.txt</a><ul>
                        
                <li>
                    <a href="#flag-format" aria-label="Flag format">Flag format</a></li></ul>
                </li>
                <li>
                    <a href="#6" aria-label="6">6</a></li></ul>
                    
                <li>
                    <a href="#random-notes" aria-label="RANDOM NOTES">RANDOM NOTES</a><ul>
                        
                <li>
                    <a href="#checkpoint-2" aria-label="Checkpoint 2">Checkpoint 2</a><ul>
                        
                <li>
                    <a href="#obfuscated-key" aria-label="Obfuscated Key">Obfuscated Key</a></li>
                <li>
                    <a href="#private-key" aria-label="Private Key">Private Key</a></li></ul>
                </li>
                <li>
                    <a href="#checkpoint-3" aria-label="Checkpoint 3">Checkpoint 3</a></li>
                <li>
                    <a href="#break-down-of-private-key" aria-label="Break down of private key">Break down of private key</a></li>
                <li>
                    <a href="#checkpoint-4" aria-label="Checkpoint 4">Checkpoint 4</a></li>
                <li>
                    <a href="#recovery" aria-label="Recovery">Recovery</a></li>
                <li>
                    <a href="#hardware" aria-label="Hardware">Hardware</a></li>
                <li>
                    <a href="#architecture" aria-label="Architecture">Architecture</a><ul>
                        
                <li>
                    <a href="#tape-contents" aria-label="Tape contents:">Tape contents:</a></li>
                <li>
                    <a href="#laptop-contents" aria-label="Laptop contents:">Laptop contents:</a></li>
                <li>
                    <a href="#usb-contents" aria-label="USB contents:">USB contents:</a></li></ul>
                </li>
                <li>
                    <a href="#reference" aria-label="Reference">Reference</a></li>
                <li>
                    <a href="#todo" aria-label="TODO">TODO</a></li>
                <li>
                    <a href="#help" aria-label="Help">Help</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Incomplete; Probably won&rsquo;t finish</p>
<h2 id="checkpoint-1-air-gapped">Checkpoint 1: &ldquo;Air-gapped&rdquo;<a hidden class="anchor" aria-hidden="true" href="#checkpoint-1-air-gapped">#</a></h2>
<p>Points 10</p>
<blockquote>
<p>The FBI infiltrated SHINY SCORPION&rsquo;s command &amp; control network!</p>
<p>They&rsquo;ve passed along the victim database related to the campaign that targeted Keep it Simple Security (KiSSec). They&rsquo;ve also included a Python script that can deobfuscate and parse the ransomware config.</p>
<p>FBI intelligence indicates that it should be possible to undo the ransomware&rsquo;s encryption using the information stored in these files!</p>
<p>Before we start any decryption, though, they suggest finding our unique victim ID.</p>
</blockquote>
<p>We were given a zip containing most files we would need.
In the FBI directory was a readme, a config parser, and the database of victims that Shiny Scorpion had exploited, <code>–∫–ª–∏–µ–Ω—Ç—ã.db</code> . I opened the binary using <a href="https://sqliteviewer.app/">https://sqliteviewer.app/</a> to make the db easier to parse. There were three columns: <code>id</code>, <code>amt</code>, and the <code>key</code> .</p>
<pre tabindex="0"><code>id = victim id
amt = money to pay
key = encoded RSA private key
</code></pre><p>I found a record that looked familiar: the id was the address that our breached company was to send $500,000 worth of bitcoin to as stated in <code>ransom.txt</code>.
<img loading="lazy" src="db_image.png" alt="image"  />

Flag: <code>14hahahaEvMFqrCd2J9vsNjaUhjEdYCsTnG3r</code></p>
<h2 id="checkpoint-2-the-last-easy-one-for-a-while">Checkpoint 2: The last easy one for a while<a hidden class="anchor" aria-hidden="true" href="#checkpoint-2-the-last-easy-one-for-a-while">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>Now that we know our &ldquo;customer&rdquo; ID, we should be able to find the ransomware&rsquo;s decryption key.</p>
<h3 id="flag">Flag<a hidden class="anchor" aria-hidden="true" href="#flag">#</a></h3>
<p>CTFd has some limitations that make it impossible to submit the key directly üòû</p>
<p>Instead, please generate and submit a SHA256 checksum of the key.</p>
<h4 id="format">Format<a hidden class="anchor" aria-hidden="true" href="#format">#</a></h4>
<p>SHA256 digest, 64 hexadecimal digits, case-insensitive</p>
<p>When hashing, ensure that you don&rsquo;t accidentally introduce any leading or trailing whitespace around the key. Any changes, no matter how small, will generate a completely different hash. Be careful copy/pasting!</p>
</blockquote>
<p>I took the key from the user db. I noticed that there was a repeating string at the beginning and end of the key: <code>YF0gY</code> . As the malware config used a public key and knowing that a private key started with <code>-----BEGIN RSA PRIVATE KEY-----</code>, I came to the conclusion that it had to be obfuscated. The <code>=</code> hinted towards base64. I tried it with ROT13,  and it worked!</p>
<p>From there, I got the sha256 checksum.</p>
<pre tabindex="0"><code>cat key.txt | sha256sum
</code></pre><p>flag: <code>a92bbe46078d2295353bad012292f84ee0564ffb89f7bbe7cb945b8cbf1d1e51</code></p>
<p><em>Note: Check the appendix for the encoded decoded private key.</em></p>
<h2 id="checkpoint-3-infinite-monkey-theorem">Checkpoint 3: Infinite monkey theorem<a hidden class="anchor" aria-hidden="true" href="#checkpoint-3-infinite-monkey-theorem">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>Now that we&rsquo;ve got the key, we should be able to make some headway on those encrypted files.</p>
<p>The README would be a great place to start!</p>
<p>Flag format</p>
<p>cp3:rest_of_the_flag, including the cp3: part, case-sensitive</p>
</blockquote>
<ul>
<li>Tried just uploading the file in cyberchef and decrypting with cyberchef, but didn&rsquo;t work because the message length was invalid.</li>
<li>RSA is used to encrypt messages that are shorter than the modulus of the public key.</li>
</ul>
<pre tabindex="0"><code>-----BEGIN RSA PRIVATE KEY-----
RSAPrivateKey ::= SEQUENCE {
  version           Version,
  modulus           INTEGER,  -- n
  publicExponent    INTEGER,  -- e
  privateExponent   INTEGER,  -- d
  prime1            INTEGER,  -- p
  prime2            INTEGER,  -- q
  exponent1         INTEGER,  -- d mod (p-1)
  exponent2         INTEGER,  -- d mod (q-1)
  coefficient       INTEGER,  -- (inverse of q) mod p
  otherPrimeInfos   OtherPrimeInfos OPTIONAL
}
-----END RSA PRIVATE KEY-----
</code></pre><p>As the private key was 4096, the maximum length that a message could be encrypted is 512 bytes.</p>
<ul>
<li>Decrypted with the first 512 bytes:</li>
</ul>
<pre tabindex="0"><code>L3NmBaEbnKAsp2uiqJkxK2WyK3WuozEioFRuVFRuVFR=
xjgufagfCj+xBeAm5brk4D==
</code></pre><p>From base64 ROT13:
flag: <code>cp3:this_should_be_random!!!!!!!</code></p>
<h3 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<ul>
<li><a href="https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths">https://security.stackexchange.com/questions/90169/rsa-public-key-and-private-key-lengths</a></li>
<li><a href="https://www.dcode.fr/rsa-cipher">https://www.dcode.fr/rsa-cipher</a></li>
</ul>
<h2 id="checkpoint-4-call-for-backup">Checkpoint 4: Call for backup<a hidden class="anchor" aria-hidden="true" href="#checkpoint-4-call-for-backup">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>We need to decrypt the rest of the README.</p>
<p>It should contain contact information for the contractors that originally set this backup system up.</p>
<p>What is the phone number for their emergency hotline?</p>
</blockquote>
<p>Key : <code>cp3:this_should_be_random!!!!!!!</code>
IV: <code>¬ìa¬≤{l?¬§:¬≥s√¶¬á¬±√°</code></p>
<p>AES Decrypt CBC/NoPadding</p>
<p>flag: <code>+1 (123) 867-5309</code></p>
<h2 id="checkpoint-5-raise-the-flagtxt">Checkpoint 5: Raise the flag.txt<a hidden class="anchor" aria-hidden="true" href="#checkpoint-5-raise-the-flagtxt">#</a></h2>
<p>Points: 10</p>
<blockquote>
<p>No luck with the contractors yet; even in this emergency their fees were still deemed too high.</p>
<p>The recovery key&rsquo;s not in the README, so we need to decrypt the rest of the files for them anyways.</p>
<h3 id="flag-format">Flag format<a hidden class="anchor" aria-hidden="true" href="#flag-format">#</a></h3>
<p><code>cp5:the_rest_the_flag</code>, with or without the <code>cp5</code> part, case-insensitive</p>
</blockquote>
<p>in keyfile bin:</p>
<p>RSA Decrypt the first 512 bytes:
cf076bf736b981a70b33e3480127572ea1be1beb97ba2e0
f601f99df6bacac9dd1dd6e7f113cb786</p>
<pre tabindex="0"><code>mjqe9mn5tnpYZ+AVNFqKYdT+T+hKhv4XQTrNURq+tb8=
LO+M32hfeW3E3J5/RGl3ut==
</code></pre><p>base64</p>
<pre tabindex="0"><code>√èk√∑6¬π¬Å¬ß3√£H&#39;W.¬°¬æ√´¬ó¬∫.
g¬ÄG~¬Ç¬è`¬ô√ük¬¨¬¨¬ù√ë√ùn&lt;¬∑¬Ü
</code></pre><p>Convert from base 64
Kinda stuck on this.
Idea so far:</p>
<ul>
<li>Need to decrypt files with RSA key and AES. However, so far, it just isn&rsquo;t working.</li>
<li>What I can do so far: Extract the base64 with the RSA key.
<ul>
<li>Need to make sense of wtf the key is supposed to be</li>
</ul>
</li>
<li>Decrypt with AES</li>
<li>Get rid of first 512 bytes maybe of the decrypted text.</li>
</ul>
<p>Python Script:</p>
<pre tabindex="0"><code>from Crypto.Cipher import AES

def __unpad(plain_text):
¬† ¬† last_character = plain_text[len(plain_text) - 1:]
¬† ¬† return plain_text[:-ord(last_character)]

for i in range(1, 102):
¬† ¬† with open(f&#34;cyberchef/{i}.txt&#34;, &#34;r&#34;) as aesFile:
¬† ¬† ¬† ¬† aesData = aesFile.read()
¬† ¬† ¬† ¬† aesKey = bytearray.fromhex(aesData[:64])
¬† ¬† ¬† ¬† aesIV = bytearray.fromhex(aesData[64:])
¬† ¬† ¬† ¬† cipher = AES.new(aesKey, AES.MODE_CBC, iv=aesIV)
¬† ¬† ¬† ¬† numString = str(i).rjust(4, &#34;0&#34;)
¬† ¬† ¬† ¬† with open(f&#34;old_desktop/desktop cleanup.7z.{numString}.sting&#34;, &#34;rb&#34;) as cipherFile: ¬†
¬† ¬† ¬† ¬† ¬† ¬† ciphertext = cipherFile.read()
¬† ¬† ¬† ¬† ¬† ¬† ciphertext = ciphertext[512:]
¬† ¬† ¬† ¬† ¬† ¬† plaintext = cipher.decrypt(ciphertext)
¬† ¬† ¬† ¬† ¬† ¬† 
¬† ¬† ¬† ¬† ¬† ¬† with open(f&#34;decrypted_stuff/desktop cleanup.7z.{numString}&#34;, &#34;wb&#34;) as plainFile:
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† plainFile.write(__unpad(plaintext))
# plaintext = cipher.decrypt(ciphertext)
</code></pre><p>flag : <code>cp5:i_sure_hope_you_didn't_decrypt_this_manually</code></p>
<h2 id="6">6<a hidden class="anchor" aria-hidden="true" href="#6">#</a></h2>
<p>flag: <code>MFWG233TORPXI2DFOJSSCIJBEE======</code></p>
<h1 id="random-notes">RANDOM NOTES<a hidden class="anchor" aria-hidden="true" href="#random-notes">#</a></h1>
<h2 id="checkpoint-2">Checkpoint 2<a hidden class="anchor" aria-hidden="true" href="#checkpoint-2">#</a></h2>
<h3 id="obfuscated-key">Obfuscated Key<a hidden class="anchor" aria-hidden="true" href="#obfuscated-key">#</a></h3>
<pre tabindex="0"><code>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
</code></pre><h3 id="private-key">Private Key<a hidden class="anchor" aria-hidden="true" href="#private-key">#</a></h3>
<pre tabindex="0"><code>-----BEGIN RSA PRIVATE KEY-----
MIIJKAIBAAKCAgEAuNo/+kTP4Gg+6W1gCrMcwGsa+SzleRJQlUEyg1x+F4bmvhSU
5f5n5//7fbaSn1b03hHlwTuucIiscjc9mKiAuZgwf8qCXEKBHdXPEa0olJbh3U25
WLt1wDKL2Hxkhyxi0jLaggjdwfsLpVaN+eNQW6IzKhd2/k6fpVNJg41eupPIucsB
6bC+7p6lZKKqJVMzpfX6WiujTGzuSSMFTeXUHEBhOE49VPx2yrXbj1pgxPdFNp0i
BT7Sm2UNVNQVTywyjBWGR7oS+OeFpasRVfasFX+lHUqyUo12OAv+oU3EVAB+3JLu
jMAmg6WBavh2AZ65ziLzSpiAyhpBGnSzuh8CbFdsaIAdFZNn9OOX/7kWG67pQ//k
xDS7l7Te8QkyeI8+6GWcJlmKuAE0Z5ovYJyTTaqPGqQnX2TiZVRyY5pp1ZHjwc/s
hraGICrJ/ZvTL/F0PyPALSt1iF4nJ5rvVMRldwy3iCArxrgMTL/AEib4yi1rVK8Y
nB5aTv0GAY/Uao/xZiiKuiYB18LUGfSKD6ZgYQqprGlydCcuYqOTUKDMg/lfaJpx
OjI3h5/mjnKJ2CTJcLSLMSoMtec2eqO16WAnV1odoXslfqLm1xnZf5y4LYTkT+9x
QlCVILc7TmqsB5jYkZkDle0dd35OX9vwTECJE3Dvu1aLvnEL0b3UM/QxZgcCAwEA
AQKCAgBtCnlA5USGiJfL1HQZ+6wTKVsA72XxtEcKtCna6T2MHUyRhcyLmzWp2gt9
DaySB5ZsRLx17wGoakbnHQTdv1Anqsm5KDkbuTM26T+7mpxcgmB7zfRuji4YkPiD
XGVkg19LxSm2GQrO+YrWHiej514on5Z01uCfhLuRp36u9j6R6sk2J7VaJ6OJWNYR
dg7N87V8yYvDkwhB9ePeCqV/XPpxK9ztfOGa904Pp5T7jAGXTpFqdOhzlapgdgyW
JIDpchXjInNSbkXww4nHvxB72AWMrP42ODDWl5HL3+91MU2Fi8FJ1faX2mUdtQyR
kDz0GbBbE6zWLP2Tukb7FypJuS8QvmPmu576HcQpooktlk1oka8oXzhc0jXGByaA
ApTC7p3m+3Hrlgx+3nYh2jxZCpT06yf/+sIICiwLOI0xieX/KKjakRzBxHS3RJHO
+StHtb2EtJnFlFx5iFOOareLRj3iXcuB3GvCof9828Cbe5noVNGwx2NSiLOkJFOW
/TD0vxGKY1ajqEddSVFwuKSeERHgYnBrmMLXf6YV8l89qPjuXQOsQfrPI2Bd/+Vl
ybVO8GLxCdTFKfwmBFtkBnXCc72YRwELL0uHP76/TlZAZjcab6/ibe2xJWqSxRGR
LLIKz4+Dp1nXCThkhoYxwFSVHfcyjrAMCu/iLGd0Z9KpH5PP0QKCAQEA6qIXIGRT
//DPFsUMCF/YYasJrwtE/g5Eo876Re9ERclF9egPWB43mimQyEYjrPoMuf8XsxZi
fALCdUOkb5QccN9E/KQDKz8909p/iZoytBVccCTuXL3/fwa53o0mSesOfSdkOLZk
ZQhKMTkxrmWfbihl1vNoD6UzqaJQ1fg01rlY6hmPltyDzFES5RBXFK+ycCS+rcoC
zHQwUzGsHfgMBpD/NkSn7jM+6+gEWSWlBJYEVZtwCCmaPFLMEbQhQghLDQj8mi68
+WMU48PQihOqIKCNFDuLrkusXX0q7w/HQHEK9fgbhEH4pYWJ0JSKpciGiDbSimfS
ErthLG79XuNFSQKCAQEAya+kxJi6LlNi3RNetI2BXM583UwjAvtUgQ6KBAOTnxVG
FxhYxob2sQ5z4oLYx1LaEqBtMXwxX9tvbZsbzUn1c3mA5einj0lgNyEpF1b5dVuw
1/9vX1PvDplmrn9YTDxUazWG7GT5clSPnEVj6pcFfKaM6TdXbpl5YodycpFtkRMQ
mG9U/KP2onDRGpQNTmro3KQoY7i0Z9JgS00UwluHWFCSbGy3yOP3VIdkUDbeKTAO
eOwsBQ2JBRrXNecnvG7lYuDORvv/XTqvO2e0rASj+twy6kEThtPM1gx5rFBR8wGS
eKd09ZQoiUNDCf+q8LydDeTrxVOnaxBkmaOqaelgzwKCAQEA6SL79bya1oIRU1+h
sCSEHa/UZHC/Me09eMKtXZX78Zeng0r9DCKiPvU0HjvLMRIYWSvGAbWpT+1yCRCY
MCIsDF9c7eeOGoexSHMgLLrhzJw5CFk52z8SwsYNI7x+og4EjIj6hXt90AHnrndV
DSN+wfc0EdwztvAAoHpe9ey1m/H5DkstqModz4NzUdXloPFfTRzFtms2Uq7UYaXG
jtSsJk4muGaJsh6LU95ri6TjDeZ+Eg3ryMCFt5DRonmoXjNdV2tpi04LiYVQ+WvV
J42YiujcpZDxHtOkRhSb94RnCHoKWRMZTFY82UMSCAXAqi/QtUI7+zhjvScgzATQ
j1sluQKCAQA3xb2PrBhYNTDyp6eZ0EPEsUkwPRy1d2Dv62BZKdAJvu1J966c/7d6
UN/U9JAT1qJ9YiWv+IMC2gCfU7RFeb1JeIEfks27PvQ/aokdbiy/umJV6MoYl3JV
HDCb8pUtR8WkfAHanzWn2yB3e2zc83RN+xSebXJdIE3D5GbOrc6ZvqbpMGhVENZk
J0R70BM56zCHy1Fr+ijRSQjd6evir0LnNii3mPzdrcS4eFRSJkobI7Hs2Ip3vz1z
zu9SdaC0aApA5J/GW2tLka3hhJUeuI3MElZ2FxbaQvmy+3IuJ2vyAi5J9SzPuG/Z
PWNtgWj493+K1xIn2DFE1xyqq+q1LRdbAoIBAFijy2YwC32h9NNj6lko/vmm4Gte
IAI8UfRCXasDh9JMnNoJdSZO9NUJWgvxEhWYBI/QI+K097OL1KfleOsR1nTMUHh8
O/TMpo1QxrSC2GT6ODm8ZhfRWcKwA141yrVISHuBIKeLG9/mHsZlyrWeOD+k6f7+
h59tBfhUF+9+JE/xmiIM0jPtyRvn7i66Eki/ZG8wyaar4qzwRDBtJfqubeLWFiCx
93b0Csxdf9heFae10IVIyKBRVEfiLv1lsIsH+a+BzDes+0y4+a2XjZjpv+Aq4jdV
eXSohcSVokYX3Wt5heSq+dGSnYiHxGA7RFyK8IWLAZu5BhRee03P1nHtYr8=
-----END RSA PRIVATE KEY-----
</code></pre><h2 id="checkpoint-3">Checkpoint 3<a hidden class="anchor" aria-hidden="true" href="#checkpoint-3">#</a></h2>
<h2 id="break-down-of-private-key">Break down of private key<a hidden class="anchor" aria-hidden="true" href="#break-down-of-private-key">#</a></h2>
<pre tabindex="0"><code>n= 754132563051154723403056919085147110311133969558691172856763166524777168216327231572688983272651071384410989555765073384227847203967898583163778576674592638643894981063661758701895920293752410921904830425769840957388609936914426615449641253167341554558554896373279982678489077450677056403673579582197256645666964578855498707133133520774701913984887474507699727510225382531085555646232361369589782565347533475192685577520962875555257293624776892223997768842012136044305966952644626419533183179058216496711599208997691198629424782252445331648629055085283904880421614417255352679652743508611647403689314891629287925358294341834219043393585986994642657061012385558466362837408728572409995430373373914848887867170333924758538747997757627071801942338132033490742485200905279828308647666846410535414695804958619756196798192136283218901229315089387818331114101607912554296186569958878491168304917484637812697279431567296217310773651137984960810009666264110079742835171525714026020997412734485334841653350210761671402225532082583194765792779700038176856577873636425662145937788074423007467772148122154326183096029207961687986811780220913433282966678342660918132055128232450696197630100253626488669210066100888824348737281133173304845579412999 

e= 65537


d = 444848112592803919191277864945186721050980791448638815500703530138415865023955848533936301697322394504630124131960907151088153944461830589232471977595298485089862765658179347996652187049089437322885070104366026543352400499735642744200492564600092423481074411994669131183418668006862143880702761998079920421515162177914380037521702378498088122629076168835820433736939485531367570925243707496329880894666681364991898190966673845401692047457775758372942456103626152666994588956197088862058582610116599654338369376392598746476264288220353145188280675657140096110170120569398579111687984059377415459652184634565156200412349842307478993214342508757083636120926301335692205947748178813477405599214801815347774543584973770843772818771124872590232967245303988658658134678249963442159036841649693249092984575182591856634390232750683306363544630805469532809144470820886907591825604716468767798385224161783851629890408039558835483740980322398095901172896150846694201756162369137023747144163734463876587528543321411884430475826359885640569384581558444391957088839672994266181345464758927043135541707134214557969972110812763106085036691439133145059124009972496173175277957308377534594150843570239663860992616991463371579776048299063414510832570321 

p= 29619693086752711766021320625068275863761447740035882305415221373897944301508180673276038882880573629992892857285938836226023124608787436752411636144902417215966096669674265733140409695828506298986141448818642507196716040955120246370386206384847545783408518406172857581502254875790712378908742886712556322269380555485452742280777508292098844527593121389676061356774791843328356176213860412135636821224805836017635135730756621911219268023402924056094485784295209274462808479945005504161284005934293403969538876771571212644411568533925099142424724554130367207976779229010512231394539878815722382848358286098653037937993

q = 25460512397693866372980588707822354119704308422591700762218265832943479094435728938872640441714298908148555060200321284902131108412210985248560012716406948618825611895457745513653222321392804303046726085650461979598069725427530550329964808173888419730493851988042069672885317171725177737179962758468744778792518468198265900094686580064425581124462711544611663414177299764828259843914504646060864449181380524220731758105814571430737656140738788098202604809442792736003230833005267659506870028431189727697264835528888953071167636345837250606086986022267874011873983650256282179190462959490422992139974356437243617960143

dmp1= 29430776418149287234562802352622504172792189379791516545559512956755119016279524806797112715173109452851170941202725957492750657665130065365828361599095175346544642706143377180468595434375337621247212185568780710532110897217701074559305115790696664996410871875300522038693338652312669170120060851730090714403463576188369884562643248279188621035328691758461867944700210111016665789384170410269932010335201965845741831387630505855267826028288981973676195428346121011699400726391791101598770971854605065430099060324518146942817598171424821567291081957373932011172923487708249477336177157462212579896886388337247465973177dmq17040616234850633081732871647342181114658913003992086804609329564832608627621934411999158684791617546002659007217456133882864978222294271719176238009970598742984521177066095822877723242299796944994671969272980491268379962981569741728030764583904967129647986321914131386570953859700251707141194517169370914537693397609856613934357765697355460376865552608801092147262389240245701712792202384920900352663597040457334355435123326945683484783230984889508610509506564730680173831370896833746479172456146168348528779380961205067500359697508407353618787061988810606484767470186224604932614556889160869227348753554666311980891

iqmp = 11189740929117537969824023300230738150107991156370618382495471880429452034455487515216178022590736073233261472653559078493715464148137211339924958961731816784132712329088002190498783589140155408064576534314899706633172767848157833801182456574698733900779320799873806292980672045756164339890172911335565832039216656177027927640142834517596282977009036183634786371922040319146715581022085409348646273894855663683921072095426601622999851082503292037562512135101302312256155521247862483338388580064120104061339213825399930063472280827979159422806485373220500086750207047726859247411928439097893506143942281890245867561663

bits = 4096
</code></pre><h2 id="checkpoint-4">Checkpoint 4<a hidden class="anchor" aria-hidden="true" href="#checkpoint-4">#</a></h2>
<p>The entire read me</p>
<hr>
<p>Recovery Instructions</p>
<p>Created: 2021-03-15, <a href="mailto:ohuile@tbo.example">Olivia Huile, TBO</a></p>
<p>Last updated: 2022-04-20, <a href="mailto:bart.thatch@kissec.net.example">bart</a></p>
<h2 id="recovery">Recovery<a hidden class="anchor" aria-hidden="true" href="#recovery">#</a></h2>
<p>It&rsquo;s as easy as 1, 2, 3!</p>
<ol>
<li>Insert one of the recovery USB thumb drives into this air-gapped laptop</li>
<li>Double-click <code>recover.py</code> on the desktop and follow the onscreen instructions</li>
<li>Transmit the (case-insensitive) output to the storage team, so they can decrypt the tape</li>
</ol>
<h2 id="hardware">Hardware<a hidden class="anchor" aria-hidden="true" href="#hardware">#</a></h2>
<ul>
<li>4x LTO-6 drives rotated monthly to Steel Mountain&rsquo;s secure facility</li>
<li>1x air-gapped recovery laptop (you&rsquo;re looking at it)</li>
<li>2x recovery USB thumb drives
<ul>
<li>1 primary stored in admin&rsquo;s locking file cabinet.
Contact <a href="mailto:bart.thatch@kissec.net.example">Bart Thatch</a> for more info.</li>
<li>1 backup kept in bank safe deposit box. Contact <a href="legal@kissec.net.example">legal team</a> for retrieval info.</li>
</ul>
</li>
</ul>
<h2 id="architecture">Architecture<a hidden class="anchor" aria-hidden="true" href="#architecture">#</a></h2>
<h3 id="tape-contents">Tape contents:<a hidden class="anchor" aria-hidden="true" href="#tape-contents">#</a></h3>
<ul>
<li><code>key.enc.b32.txt</code> - recovery key blob, Base32-encoded (see details <a href="#Reference">below</a>)</li>
<li><code>nonce.bin</code> - AES-CTR nonce</li>
<li><code>&lt;date of snapshot&gt;.tgz.aes.bin</code>: the backup archive, encrypted using included (encrypted) AES-128 key</li>
</ul>
<h3 id="laptop-contents">Laptop contents:<a hidden class="anchor" aria-hidden="true" href="#laptop-contents">#</a></h3>
<ul>
<li><code>recover.py</code> - script that decrypts recovery key</li>
<li><code>offline_recovery.kbdx</code> - KeePass DB containing private key</li>
<li>this README</li>
</ul>
<h3 id="usb-contents">USB contents:<a hidden class="anchor" aria-hidden="true" href="#usb-contents">#</a></h3>
<ul>
<li><code>key.bin</code> - KeePass key file</li>
</ul>
<h2 id="reference">Reference<a hidden class="anchor" aria-hidden="true" href="#reference">#</a></h2>
<p>Recovery key blob in <code>key.enc.b32.txt</code>.</p>
<p>Struct is Base32-encoded for easier transfer over the phone.
All sizes in decimal bytes:</p>
<table>
<thead>
<tr>
<th>Offset</th>
<th>Length</th>
<th>Type (golang)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>12</td>
<td><code>[]byte</code></td>
<td>ChaCha20-Poly1305 nonce</td>
</tr>
<tr>
<td>12</td>
<td>32</td>
<td><code>[]byte</code></td>
<td>Encrypted (ChaCha20-Poly1305) AES-128-CTR key</td>
</tr>
<tr>
<td>60</td>
<td>1</td>
<td><code>uint8</code></td>
<td>Size of Public Key data (next field)</td>
</tr>
<tr>
<td>61</td>
<td>see prev</td>
<td><code>[]byte</code></td>
<td>X9.62-compressed secp256r1 Public Key</td>
</tr>
</tbody>
</table>
<p>Note: the ChaCha20-Poly1305 Authenticated Encryption uses the Public Key bytes as Authenticated Data.</p>
<pre tabindex="0"><code>0 - 11 mjqe9mn5tnpY

12- 31 Z+AVNFqKYdT+T+hKhv4XQTrNURq+tb8=

LO+M32hfeW3E3J5

60 /

61 RGl3ut==
</code></pre><h2 id="todo">TODO<a hidden class="anchor" aria-hidden="true" href="#todo">#</a></h2>
<ul>
<li>Remove KeePass dependency (legacy requirement)</li>
<li>Disable network devices on this laptop to prevent accidental connections</li>
</ul>
<h2 id="help">Help<a hidden class="anchor" aria-hidden="true" href="#help">#</a></h2>
<p>Drop us a question in the #infrasec-support Slack channel,
or email us at <a href="mailto:infrasec@kissec.net.example">infrasec@kissec.example</a>.</p>
<p>For emergency recovery operations, call the original contractor&rsquo;s hotline.</p>
<p>Tailored Backup Operations: +1 (123) 867-5309</p>
<p>From yarrr.url.sting:</p>
<pre tabindex="0"><code>nCZ5KjTkXsoht7OD1TiJ965lw1q1HoW9at5etCJ9xRb=
SQvrk8kmMRNJFiuWqa//lj==
</code></pre><pre tabindex="0"><code>√®hb¬ëu¬üH4¬Ω3N¬∂√Ç¬Ñ:
t]
URL=https://thepiratebay.org.example
IDList=
HotKey=0
</code></pre><p>Desktop2:</p>
<pre tabindex="0"><code>WS4yqIWqJyTtRSN9qYI2nMDmHQy42/YmajWiS2mMAr0=
srZqE2kuJDbKVYbLvmvAVj==
</code></pre><p>Desktop3</p>
<pre tabindex="0"><code>wHTBeVjZTRSlKjEvhAtyocM4YT9+LmAxX0ZoifVcFdH=
BGCgcVZ3xW6fx7heYK01xj==
</code></pre><p>Desktop 32</p>
<pre tabindex="0"><code>va+11hLjyQ3r1Yr2XjokOMzpQqL3UvphdetQ+92mkHV=
TqsdXribAvR8QGzhEXdApt==
</code></pre><p><img loading="lazy" src="keyfilebin_image.png" alt="image"  />

<code>ee2:i_yam_what_i_yam</code></p>
<p>cf076bf736b981a70b33e3480127572ea1be1beb97ba2e0a0c67801c477e828f
601f99df6bacac9dd1dd6e7f113cb786</p>
<p>^^^ keyfile</p>
<p>472ff95a432f44c15187c21253d98bcd5ce2338a8b92fb3e75377dd58ba91671
c7b2a189cfb775cc18d66f27c32d9f91
El/5JxZiEZSEu8VFH9zYmImvZ4dYxif+qGq91LhcSaR=
k7Xuvp+3qpjL1z8ajl2sxD==</p>
<p>G/√πZC/D√ÅQ¬á√ÇS√ô¬ã√ç\√¢3¬ä¬ã¬í√ª&gt;u7}√ï¬ã¬©q√á¬≤¬°¬â√è¬∑u√å√ño&rsquo;√É-¬ü¬ë
^ 0001</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://g0ldf15h.github.io/posts/dev_notes/python/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>Python Notes</span>
  </a>
  <a class="next" href="https://g0ldf15h.github.io/posts/target_ctf/tier1/target1/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>Target I: Cryptography and Steganography</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://g0ldf15h.github.io/">goldfish</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
